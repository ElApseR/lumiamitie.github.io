<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
<title type="text">lmnsh</title>
<generator uri="https://github.com/mojombo/jekyll">Jekyll</generator>
<link rel="self" type="application/atom+xml" href="http://lumiamitie.github.io/feed.xml" />
<link rel="alternate" type="text/html" href="http://lumiamitie.github.io" />
<updated>2015-09-02T12:33:25+09:00</updated>
<id>http://lumiamitie.github.io/</id>
<author>
  <name>Minho Lee</name>
  <uri>http://lumiamitie.github.io/</uri>
  <email>lumiamitie@email.com</email>
</author>


<entry>
  <title type="html"><![CDATA[Web Scraping with rvest]]></title>
  <link>http://lumiamitie.github.io/r/web/web-scraping-with-rvest</link>
  <id>http://lumiamitie.github.io/r/web/web-scraping-with-rvest</id>
  <published>2015-09-02T00:00:00+09:00</published>
  <updated>2015-09-02T00:00:00+09:00</updated>
  <author>
    <name>Minho Lee</name>
    <uri>http://lumiamitie.github.io</uri>
    <email>lumiamitie@email.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;img src=&quot;../../../images/taking-notes.jpg&quot; alt=&quot;cover-image&quot;&gt;&lt;/p&gt;

&lt;h1 id=&quot;web-scraping-with-rvest&quot;&gt;Web Scraping with rvest&lt;/h1&gt;

&lt;p&gt;꿈꾸는 데이터 디자이너 2기의 수업 보조자료입니다
강의자료는 &lt;a href=&quot;http://www.slideshare.net/neuroassociates/week5rscraping&quot;&gt;이 곳&lt;/a&gt;에서 확인하실 수 있습니다&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h1 id=&quot;rvest&quot;&gt;rvest&lt;/h1&gt;

&lt;p&gt;rvest는 html과 xml 자료를 쉽게 가져와서 처리할 수 있도록 해주는 Hadley Wickham의 패키지이다. 파이썬의 BeautifulSoup 등을 참고해서 기존에 있던 패키지들 보다 더 간단한 문법으로 데이터를 처리하고, Hadley Wickham의 다른 패키지들 처럼 &lt;code&gt;%&amp;gt;%&lt;/code&gt;연산자를 활용하기 쉽게 구성되었다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;h1 id=&quot;html&quot;&gt;HTML&lt;/h1&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dplyr&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rvest&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# url을 chr에 저장한다&lt;/span&gt;
daum_bball &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;http://score.sports.media.daum.net/record/baseball/kbo/prnk.daum&amp;#39;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# html()함수를 통해 해당 주소를 긁어오고 html 형태로 파싱한다&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# encoding은 &amp;#39;UTF-8&amp;#39;로 지정한다&lt;/span&gt;
daum_bball_html &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; html&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;daum_bball&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; encoding&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;UTF-8&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;html 문서 내에서 &lt;code&gt;html_node()&lt;/code&gt;함수를 통해 &lt;strong&gt;id값이 table1인 항목&lt;/strong&gt;을 찾고&lt;/p&gt;

&lt;p&gt;table 태그 내부의 자료를 &lt;code&gt;html_table()&lt;/code&gt;을 통해 data.frame 형태로 자료를 가져온다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;bball_table &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; html_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;daum_bball_html&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;#table1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
html_table&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bball_table&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##    순위       선수 (팀) 경기 승 패 세이브 홀드    이닝 투구수 피안타
## 1     1    양현종 (KIA)   26 12  5      0    1 152 2/3   2488    123
## 2     2       해커 (NC)   25 16  4      0    0 166 1/3   2511    135
## 3     3   유희관 (두산)   24 16  4      0    0 163 1/3   2503    155
## 4     4 린드블럼 (롯데)   26 11  7      0    0     174   2731    158
## 5     5   장원준 (두산)   24 11  9      0    0 142 1/3   2402    146
## 6     6   윤성환 (삼성)   24 13  7      0    0     160   2483    156
## 7     7   피가로 (삼성)   23 12  6      0    0     152   2453    145
## 8     8   밴헤켄 (넥센)   26 12  6      0    0 162 1/3   2666    154
## 9     9     김광현 (SK)   23 11  3      0    0     136   2268    138
## 10   10   레일리 (롯데)   26  7  8      0    0     146   2400    155
## 11   11 피어밴드 (넥센)   25 11  8      0    0 149 1/3   2432    162
## 12   12   옥스프링 (kt)   26  9  9      0    0     159   2677    164
## 13   13       켈리 (SK)   23  7  9      0    0 142 2/3   2239    152
## 14   14       소사 (LG)   25  8 10      0    1 153 1/3   2459    159
## 15   15    스틴슨 (KIA)   27 10  8      0    0 151 1/3   2539    167
## 16   16   차우찬 (삼성)   24  9  5      0    0     143   2510    131
## 17   17 클로이드 (삼성)   23 10  8      0    0 133 1/3   2259    155
## 18   18     루카스 (LG)   28  8  9      0    1 142 1/3   2733    140
## 19   19   탈보트 (한화)   25  8  9      0    0     126   2299    131
##    피홈런 탈삼진 사사구 실점 자책 평균자책 WHIP QS
## 1      15    125     62   41   39     2.30 1.21 16
## 2       9    143     30   58   48     2.60 0.99 21
## 3      17    113     37   58   57     3.14 1.18 15
## 4      21    141     41   66   65     3.36 1.14 19
## 5       7    110     53   61   56     3.54 1.40 15
## 6      22    140     25   66   63     3.54 1.13 14
## 7      15    108     50   64   60     3.55 1.28 16
## 8      11    165     53   74   66     3.66 1.28 14
## 9      12    127     53   69   57     3.77 1.40 12
## 10     16    112     43   79   65     4.01 1.36 15
## 11     16    122     49   73   68     4.10 1.41 16
## 12     20    122     56   85   73     4.13 1.38 13
## 13     14    104     42   70   66     4.16 1.36 13
## 14     15    129     29   84   72     4.23 1.23 14
## 15     13     80     56   83   77     4.58 1.47 11
## 16     24    150     59   80   75     4.72 1.33 15
## 17     17     97     32   76   71     4.79 1.40 13
## 18     11    134     90   85   78     4.93 1.62  9
## 19     11     91     69   83   74     5.29 1.59 10
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;pipe 연산자를 통해 표현하면 다음과 같다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;daum_bball_html &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  html_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;#table1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  html_table&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;html_table()&lt;/code&gt;함수의 경우 윈도우 환경에서는 아직 인코딩을 제대로 처리하지 못하는 것으로 보인다&lt;/p&gt;

&lt;p&gt;&lt;code&gt;rvest&lt;/code&gt; 이전에 사용하던 &lt;code&gt;XML&lt;/code&gt;과 &lt;code&gt;RCurl&lt;/code&gt; 패키지를 이용해서 비슷한 방식으로 가지고 올 수 있다&lt;/p&gt;

&lt;p&gt;글의 맨 마지막 부분에서 코드를 살펴볼 수 있다&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;&lt;code&gt;html_node()&lt;/code&gt; 함수는 node이름이나 css주소, xpath등을 받으면 해당하는 요소를 &lt;strong&gt;1개만&lt;/strong&gt; 반환한다&lt;/p&gt;

&lt;p&gt;테이블의 header 부분 정보를 담고있는 thead 태그 내부에서 html_node(&amp;lsquo;th&amp;rsquo;)로 th 태그의 항목들을 검색해보면&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;가장 첫 번째 th 요소&lt;/strong&gt;를 태그와 내용을 함께 반환한다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;bball_thead &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; html_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;daum_bball_html&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;thead&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
html_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bball_thead&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;th&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;순위&amp;lt;/th&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# pipe&lt;/span&gt;
daum_bball_html &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  html_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;thead&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  html_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;th&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;html_nodes()&lt;/code&gt; 함수는 해당하는 요소를 전부 반환한다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;html_nodes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bball_thead&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;th&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [[1]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;순위&amp;lt;/th&amp;gt; 
## 
## [[2]]
## &amp;lt;th class=&amp;quot;txt_league&amp;quot; scope=&amp;quot;col&amp;quot;&amp;gt;선수 &amp;lt;em&amp;gt;(팀)&amp;lt;/em&amp;gt;&amp;lt;/th&amp;gt; 
## 
## [[3]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=GP&amp;amp;amp;ord=DESC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;경기&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[4]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=W&amp;amp;amp;ord=DESC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;승&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[5]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=L&amp;amp;amp;ord=DESC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;패&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[6]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=SV&amp;amp;amp;ord=DESC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;세이브&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[7]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=HLD&amp;amp;amp;ord=DESC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;홀드&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[8]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=IP&amp;amp;amp;ord=DESC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;이닝&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[9]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=NP&amp;amp;amp;ord=DESC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;투구수&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[10]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=HIT&amp;amp;amp;ord=DESC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;피안타&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[11]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=HR&amp;amp;amp;ord=DESC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;피홈런&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[12]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=SO&amp;amp;amp;ord=DESC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;탈삼진&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[13]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=BB&amp;amp;amp;ord=DESC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;사사구&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[14]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=R&amp;amp;amp;ord=DESC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;실점&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[15]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=ER&amp;amp;amp;ord=DESC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;자책&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[16]]
## &amp;lt;th scope=&amp;quot;col&amp;quot; class=&amp;quot;on&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=ERA&amp;amp;amp;ord=ASC&amp;quot; data-type=&amp;quot;reverse&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;평균자책&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[17]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=WHIP&amp;amp;amp;ord=ASC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;WHIP&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## [[18]]
## &amp;lt;th scope=&amp;quot;col&amp;quot;&amp;gt;
##   &amp;lt;a href=&amp;quot;?season_id=2015&amp;amp;amp;col=QS&amp;amp;amp;ord=DESC&amp;quot; class=&amp;quot;ico_comm3 btn_align&amp;quot;&amp;gt;QS&amp;lt;/a&amp;gt;
## &amp;lt;/th&amp;gt; 
## 
## attr(,&amp;quot;class&amp;quot;)
## [1] &amp;quot;XMLNodeSet&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# pipe&lt;/span&gt;
daum_bball_html &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  html_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;thead&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  html_nodes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;th&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;요소를 반환 받았을 때 html_text() 함수를 이용해 내용만 추출할 수 있다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;html_text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;html_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bball_thead&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;th&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] &amp;quot;순위&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# pipe&lt;/span&gt;
daum_bball_html &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  html_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;thead&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  html_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;th&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  html_text&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;html_text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;html_nodes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bball_thead&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;th&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##  [1] &amp;quot;순위&amp;quot;      &amp;quot;선수 (팀)&amp;quot; &amp;quot;경기&amp;quot;      &amp;quot;승&amp;quot;        &amp;quot;패&amp;quot;       
##  [6] &amp;quot;세이브&amp;quot;    &amp;quot;홀드&amp;quot;      &amp;quot;이닝&amp;quot;      &amp;quot;투구수&amp;quot;    &amp;quot;피안타&amp;quot;   
## [11] &amp;quot;피홈런&amp;quot;    &amp;quot;탈삼진&amp;quot;    &amp;quot;사사구&amp;quot;    &amp;quot;실점&amp;quot;      &amp;quot;자책&amp;quot;     
## [16] &amp;quot;평균자책&amp;quot;  &amp;quot;WHIP&amp;quot;      &amp;quot;QS&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# pipe&lt;/span&gt;
daum_bball_html &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  html_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;thead&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  html_nodes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;th&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  html_text&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h1 id=&quot;xml&quot;&gt;XML&lt;/h1&gt;

&lt;p&gt;xml자료를 가져올때는 &lt;code&gt;xml()&lt;/code&gt;을 사용하고&lt;/p&gt;

&lt;p&gt;&lt;code&gt;xml_node()&lt;/code&gt;, &lt;code&gt;xml_nodes()&lt;/code&gt;, &lt;code&gt;xml_text()&lt;/code&gt;등의 함수를 사용할 수 있다.&lt;/p&gt;

&lt;p&gt;html 함수들과 사용방법은 동일하다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;boxoffice_xml &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; xml&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;boxoffice0831.xml&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; encoding &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;UTF-8&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;xml_structure&lt;/code&gt; 함수를 사용하면 xml 문서의 구조를 볼 수 있다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;xml_structure&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;boxoffice_xml&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## {DTD}
## &amp;lt;html&amp;gt;
##   &amp;lt;body&amp;gt;
##     &amp;lt;boxofficeresult&amp;gt;
##       &amp;lt;boxofficetype&amp;gt; {text}
##       &amp;lt;showrange&amp;gt; {text}
##       &amp;lt;dailyboxofficelist&amp;gt;
##         &amp;lt;dailyboxoffice&amp;gt;
##           &amp;lt;rank&amp;gt; {text}
##           &amp;lt;movienm&amp;gt; {text}
##           &amp;lt;audicnt&amp;gt; {text}
##         &amp;lt;dailyboxoffice&amp;gt;
##           &amp;lt;rank&amp;gt; {text}
##           &amp;lt;movienm&amp;gt; {text}
##           &amp;lt;audicnt&amp;gt; {text}
##         &amp;lt;dailyboxoffice&amp;gt;
##           &amp;lt;rank&amp;gt; {text}
##           &amp;lt;movienm&amp;gt; {text}
##           &amp;lt;audicnt&amp;gt; {text}
##         &amp;lt;dailyboxoffice&amp;gt;
##           &amp;lt;rank&amp;gt; {text}
##           &amp;lt;movienm&amp;gt; {text}
##           &amp;lt;audicnt&amp;gt; {text}
##         &amp;lt;dailyboxoffice&amp;gt;
##           &amp;lt;rank&amp;gt; {text}
##           &amp;lt;movienm&amp;gt; {text}
##           &amp;lt;audicnt&amp;gt; {text}
##         &amp;lt;dailyboxoffice&amp;gt;
##           &amp;lt;rank&amp;gt; {text}
##           &amp;lt;movienm&amp;gt; {text}
##           &amp;lt;audicnt&amp;gt; {text}
##         &amp;lt;dailyboxoffice&amp;gt;
##           &amp;lt;rank&amp;gt; {text}
##           &amp;lt;movienm&amp;gt; {text}
##           &amp;lt;audicnt&amp;gt; {text}
##         &amp;lt;dailyboxoffice&amp;gt;
##           &amp;lt;rank&amp;gt; {text}
##           &amp;lt;movienm&amp;gt; {text}
##           &amp;lt;audicnt&amp;gt; {text}
##         &amp;lt;dailyboxoffice&amp;gt;
##           &amp;lt;rank&amp;gt; {text}
##           &amp;lt;movienm&amp;gt; {text}
##           &amp;lt;audicnt&amp;gt; {text}
##         &amp;lt;dailyboxoffice&amp;gt;
##           &amp;lt;rank&amp;gt; {text}
##           &amp;lt;movienm&amp;gt; {text}
##           &amp;lt;audicnt&amp;gt; {text}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;html과 마찬가지로 xml_node, xml_nodes, xml_text를 통해 데이터를 추출할 수 있다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;xml_text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xml_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;boxoffice_xml&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;showrange&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] &amp;quot;20150831~20150831&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# pipe&lt;/span&gt;
boxoffice_xml &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  xml_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;showrange&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  xml_text&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;dailyboxoffice 태그들 안에 동일한 태그로 데이터가 담겨있기 때문에&lt;/p&gt;

&lt;p&gt;일단 dailyboxoffice을 선택하고(&lt;code&gt;xml_node&lt;/code&gt;)&lt;/p&gt;

&lt;p&gt;바로 원하는 자료들이 담긴 태그들에 직접 접근해서(&lt;code&gt;xml_nodes&lt;/code&gt;) 자료를 받아오려고 한다(&lt;code&gt;xml_text&lt;/code&gt;)&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;daily &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; xml_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;boxoffice_xml&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;dailyboxofficelist&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# 순위와, 영화이름, 관객 수를 각각 벡터에 저장한다&lt;/span&gt;
rank    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; xml_text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xml_nodes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;daily&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;rank&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
movieNm &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; xml_text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xml_nodes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;daily&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;movienm&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
audiCnt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; xml_text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xml_nodes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;daily&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;audicnt&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# 세 개의 벡터를 묶어서 data.frame으로 구성한다&lt;/span&gt;
daily_boxoffice &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;rank&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; movieNm&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; audiCnt&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
daily_boxoffice
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##    rank                   movieNm audiCnt
## 1     1                    베테랑  144263
## 2     2             뷰티 인사이드   59994
## 3     3                      암살   47798
## 4     4                  치외법권   26420
## 5     5               미쓰 와이프   18834
## 6     6           아메리칸 울트라   13839
## 7     7 미션 임파서블: 로그네이션   10337
## 8     8             미라클 벨리에    7203
## 9     9                  미니언즈    2756
## 10   10                판타스틱 4    2500
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;xml과-rcurl을-이용해서-table-가져오기&quot;&gt;XML과 RCurl을 이용해서 table 가져오기&lt;/h2&gt;

&lt;p&gt;윈도우에서 rvest의 &lt;code&gt;html_table&lt;/code&gt;함수가 인코딩 문제가 생긴다면 &lt;code&gt;XML&lt;/code&gt;과 &lt;code&gt;RCurl&lt;/code&gt; 패키지를 사용해서 테이블을 처리할 수 있다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;XML&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;RCurl&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;daum_bball &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;http://score.sports.media.daum.net/record/baseball/kbo/prnk.daum&amp;#39;&lt;/span&gt;
xml_daum &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; getURL&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;daum_bball&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

bball_table &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; readHTMLTable&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xml_daum&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;table1
&lt;span class=&quot;c1&quot;&gt;# 헤더 부분 인코딩이 깨지는 문제는 rvest 패키지의 repair_encoding()함수로 처리한다&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bball_table&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; repair_encoding&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bball_table&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bball_table&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##   순위       선수 (팀) 경기 승 패 세이브 홀드    이닝 투구수 피안타 피홈런
## 1    1    양현종 (KIA)   26 12  5      0    1 152 2/3   2488    123     15
## 2    2       해커 (NC)   25 16  4      0    0 166 1/3   2511    135      9
## 3    3   유희관 (두산)   24 16  4      0    0 163 1/3   2503    155     17
## 4    4 린드블럼 (롯데)   26 11  7      0    0     174   2731    158     21
## 5    5   장원준 (두산)   24 11  9      0    0 142 1/3   2402    146      7
## 6    6   윤성환 (삼성)   24 13  7      0    0     160   2483    156     22
##   탈삼진 사사구 실점 자책 평균자책 WHIP QS
## 1    125     62   41   39     2.30 1.21 16
## 2    143     30   58   48     2.60 0.99 21
## 3    113     37   58   57     3.14 1.18 15
## 4    141     41   66   65     3.36 1.14 19
## 5    110     53   61   56     3.54 1.40 15
## 6    140     25   66   63     3.54 1.13 14
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
  &lt;p&gt;&lt;a href=&quot;http://lumiamitie.github.io/r/web/web-scraping-with-rvest&quot;&gt;Web Scraping with rvest&lt;/a&gt; was originally published by Minho Lee at &lt;a href=&quot;http://lumiamitie.github.io&quot;&gt;lmnsh&lt;/a&gt; on September 02, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Jupyter with R]]></title>
  <link>http://lumiamitie.github.io/r/python/jupyter-r-kernel</link>
  <id>http://lumiamitie.github.io/r/python/jupyter-r-kernel</id>
  <published>2015-08-29T00:00:00+09:00</published>
  <updated>2015-08-29T00:00:00+09:00</updated>
  <author>
    <name>Minho Lee</name>
    <uri>http://lumiamitie.github.io</uri>
    <email>lumiamitie@email.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;img src=&quot;../../../images/rocks-waves.jpg&quot; alt=&quot;cover-image&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;jupyter&quot;&gt;jupyter&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;jupyter&lt;/strong&gt;(또는 ipython notebook)는 ipython을 기반으로 해서 코딩과 마크다운 문서작성을 함께 할 수 있게 해주는 웹기반 어플리케이션이다. 기존의 ipython 에서는 ipython만을 사용할 수 있었지만 jupyter로 업그레이드 되면서 다른 언어들도 사용할 수 있게 되었다. &lt;/p&gt;

&lt;p&gt;보통 R 관련해서 강의나 스터디와 관련된 자료를 만들 때 knit과 rmarkdown을 이용했었다. 웹페이지나 웹기반 슬라이드, pdf 등 다양한 형태로 만들 수 있다는 것이 장점이지만 그림자료가 많아질 수록 매번 knit 시키기는 시간이 너무 길어지기도 했고 코드와 주석으로만 작성되어있던 R 소스코드를 markdown형식과 code chunk의 형태로 변환하는게 번거로웠다. 마침 최근 github에서 jupyter의 ipynb파일을 직접 렌더링해주도록 업데이트 되었다는 사실을 알게 되었다. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/blog/1995-github-jupyter-notebooks-3&quot;&gt;https://github.com/blog/1995-github-jupyter-notebooks-3&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;파이썬은 jupyter로 코드를 작성하고 있었지만 R도 jupyter에서 코드를 작성해서 github에 자료를 모으면 비교적 편리하게 문서를 작성할 수 있을 것 같다는 생각이 들어서 R커널을 윈도우에 설치하는 방법을 찾아보게 되었다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;jupyter-with-r-(windows)&quot;&gt;jupyter with R (windows)&lt;/h2&gt;

&lt;p&gt;우선 여기서는 python, ipython, jupyter, 그리고 R까지 모두 설치되어 있다는 것을 전제로 진행하려고 한다. python과 R의 설치는 비교적 쉽게 할 수 있지만, ipython과 jupyter의 경우에는 구글에서 관련된 내용으로 검색해가면서 진행해야 할 것 같다. &lt;/p&gt;

&lt;p&gt;설치하는 과정은 &lt;a href=&quot;https://github.com/IRkernel/IRkernel&quot;&gt;https://github.com/IRkernel/IRkernel&lt;/a&gt; 의 readme 문서를 참고했다. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;install.packages&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;rzmq&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;repr&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;IRkernel&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;IRdisplay&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                 repos &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;http://irkernel.github.io/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;getOption&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;repos&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위와 같이 커널 설치를 위해 필요한 패키지를 한꺼번에 설치할 수 있다. 패키지를 모두 설치하고 나면&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;IRkernel&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;installspec&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 명령어를 통해 커널을 설치할 수 있다. 옵션없이 설치를 하게 되면 해당 사용자에 대해서 설치를 하게 되는데, 시스템 전체에 대해서 설치하고 싶다면 &lt;code&gt;user = FALSE&lt;/code&gt; 옵션을 추가하면 된다. 64bit 윈도우7이 설치된 i5 LG그램에서 설치를 하고 있었는데 &lt;code&gt;installspec()&lt;/code&gt; 만으로는 제대로 설치가 되지 않아서 &lt;code&gt;user = FALSE&lt;/code&gt; 옵션을 켜고 설치를 진행했다. &lt;/p&gt;

&lt;p&gt;설치가 완료되었다면 &lt;code&gt;C:\Users\[username]\Documents\.ipython\kernels\ir\kernel.json&lt;/code&gt; 등 ipython이 설치된 내부 폴더에서 R커널이 설치된 폴더로 찾아들어가야 한다. &lt;code&gt;kernel.json&lt;/code&gt; 파일을 열어보면&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;{&amp;quot;argv&amp;quot;: [&amp;quot;R&amp;quot;, &amp;quot;--quiet&amp;quot;, &amp;quot;-e&amp;quot;,&amp;quot;IRkernel::main()&amp;quot;,&amp;quot;--args&amp;quot;,&amp;quot;{connection_file}&amp;quot;],
 &amp;quot;display_name&amp;quot;:&amp;quot;R&amp;quot;,
 &amp;quot;language&amp;quot;:&amp;quot;R&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;와 같이 작성되어 있는 것을 볼 수 있다. 만약에 R 실행파일의 위치가 path로 잡혀있다면 저 상태로 실행시켜도 된다. path가 설정되어 있지 않다면 R 실행파일을 path로 잡아주거나, &lt;code&gt;&amp;quot;C:/Program Files/R/R-3.2.1/bin/R.exe&amp;quot;&lt;/code&gt; 처럼 실행파일을 직접 지정해줄 수 있다. 실행파일을 직접 지정해줄 경우 아래와 같은 형태가 된다. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;{&amp;quot;argv&amp;quot;: [&amp;quot;C:/Program Files/R/R-3.2.1/bin/R.exe&amp;quot;, &amp;quot;--quiet&amp;quot;, &amp;quot;-e&amp;quot;,&amp;quot;IRkernel::main()&amp;quot;,&amp;quot;--args&amp;quot;,&amp;quot;{connection_file}&amp;quot;],
 &amp;quot;display_name&amp;quot;:&amp;quot;R&amp;quot;,
 &amp;quot;language&amp;quot;:&amp;quot;R&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 jupyter를 실행시키면 새 파일을 생성하는 New 항목에 Python 뿐만 아니라 R이 선택 가능해진다&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/yuhz7jc2b5but7g/jupyterwithr00.PNG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;p&gt;R을 선택해서 새 파일을 만들고 &lt;code&gt;plot(iris)&lt;/code&gt; 를 작성한 후에 crtl + enter를 눌러서 코드를 실행시키면 아래처럼 제대로 실행되는 모습을 볼 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/m98koj5ytjgr54r/jupyterwithr01.PNG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;http://lumiamitie.github.io/r/python/jupyter-r-kernel&quot;&gt;Jupyter with R&lt;/a&gt; was originally published by Minho Lee at &lt;a href=&quot;http://lumiamitie.github.io&quot;&gt;lmnsh&lt;/a&gt; on August 29, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[ggplot2 - 03]]></title>
  <link>http://lumiamitie.github.io/r/visualization/ggplot2-03</link>
  <id>http://lumiamitie.github.io/r/visualization/ggplot2-03</id>
  <published>2015-08-26T00:00:00+09:00</published>
  <updated>2015-08-26T00:00:00+09:00</updated>
  <author>
    <name>Minho Lee</name>
    <uri>http://lumiamitie.github.io</uri>
    <email>lumiamitie@email.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;img src=&quot;../../../images/desk-pen-ruler.jpg&quot; alt=&quot;cover-image&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;ggplot2&quot;&gt;ggplot2&lt;/h2&gt;

&lt;p&gt;지난번 포스팅까지 해서 ggplot2의 그래프를 그리는 방법에 대해서는 전반적으로 살펴보았습니다.&lt;/p&gt;

&lt;p&gt;이번 글에서는 필수적이지는 않지만 도움이 될 만한 내용들을 몇 가지 설명하려고 합니다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;h2 id=&quot;stat이-생성하는-값들&quot;&gt;stat이 생성하는 값들&lt;/h2&gt;

&lt;p&gt;stat은 주어진 데이터프레임 이외에, 그래프를 그리는데 필요한 값을 추가로 생성해서 데이터프레임에 추가합니다.&lt;/p&gt;

&lt;p&gt;주어진 값을 그대로 사용한다는 &lt;code&gt;stat_identity()&lt;/code&gt;를 제외하면 나머지 stat 함수들은 제각기 다른 값을 생성하는데 필요하다면 여기서 생성된 값을 가져다가 에스테틱에 적용할 수 있습니다. &lt;/p&gt;

&lt;p&gt;이 때, 기존 데이터의 변수들과 구별하기 위해 변수 이름 앞뒤로 ..을 붙입니다. &lt;/p&gt;

&lt;p&gt;&lt;code&gt;..count..&lt;/code&gt;, &lt;code&gt;..density..&lt;/code&gt;와 같은 형태로 에스테틱에 적용할 수 있습니다. &lt;/p&gt;

&lt;p&gt;각 stat 함수가 어떤 값을 생성하는지는 &lt;a href=&quot;http://docs.ggplot2.org/current/&quot;&gt;http://docs.ggplot2.org/current/&lt;/a&gt;의 문서에서 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;예를 들면, stat_bin의 경우 다음과 같은 값을 추가로 생성합니다&lt;/p&gt;

&lt;p&gt;문서는 &lt;a href=&quot;http://docs.ggplot2.org/current/stat_bin.html&quot;&gt;이 곳&lt;/a&gt;에서 확인할 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;count&lt;/strong&gt; : 각 구간(bin)에 속한 항목의 개수&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;density&lt;/strong&gt; : 각 구간(bin)의 밀도(전체의 합이 1)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ncount&lt;/strong&gt; : count와 비슷합니다, 가장 큰 count 값을 1로 두고 다른 값들을 조정합니다&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ndensity&lt;/strong&gt; : density, 가장 높은 density 값이 1이 됩니다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
iris_sl &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; iris&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;Sepal.Length&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Sepal.Length&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;iris_sl &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_bar&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## stat_bin: binwidth defaulted to range/30. Use &amp;#39;binwidth = x&amp;#39; to adjust this.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/8025u8kz400f100/unnamed-chunk-2-1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;iris_sl &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_bar&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;..&lt;/span&gt;count..&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## stat_bin: binwidth defaulted to range/30. Use &amp;#39;binwidth = x&amp;#39; to adjust this.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/vpvbydcyo2hvxm4/unnamed-chunk-2-2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;iris_sl &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_bar&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;..&lt;/span&gt;density..&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## stat_bin: binwidth defaulted to range/30. Use &amp;#39;binwidth = x&amp;#39; to adjust this.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/nysh8cy9zpj92ap/unnamed-chunk-2-3.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;iris_sl &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_bar&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;..&lt;/span&gt;ncount..&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## stat_bin: binwidth defaulted to range/30. Use &amp;#39;binwidth = x&amp;#39; to adjust this.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/rystjzu8zvg75gd/unnamed-chunk-2-4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;iris_sl &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_bar&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;..&lt;/span&gt;ndensity..&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## stat_bin: binwidth defaulted to range/30. Use &amp;#39;binwidth = x&amp;#39; to adjust this.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/zfiic6cf3cx5xh2/unnamed-chunk-2-5.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;R에서 기본적으로 제공하는 volcano 데이터를 그래프로 그려보려고 합니다.&lt;/p&gt;

&lt;p&gt;reshape2 패키지의 &lt;code&gt;melt&lt;/code&gt;함수를 이용해서 데이터프레임으로 변형시키고 ggplot2로 그래프를 그립니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;volcano_df &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; reshape2&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;melt&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;volcano&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
volcano_gg &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;volcano_df&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Var1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Var2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; z &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; value&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;stat_contour&lt;/code&gt;가 생성하는 level 변수를 사용해서 그래프의 에스테틱에 반영시킬 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;volcano_gg &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; stat_contour&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/3vo9jplrtk60tby/unnamed-chunk-4-1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;volcano_gg &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; stat_contour&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;..&lt;/span&gt;level..&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/2o2agkxq60pbwzr/unnamed-chunk-4-2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;volcano_gg &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; stat_contour&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;geom &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;polygon&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;..&lt;/span&gt;level..&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/0z6kigmg6rza0p3/unnamed-chunk-4-3.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;h2 id=&quot;테마&quot;&gt;테마&lt;/h2&gt;

&lt;p&gt;축의 모양이나 배경색 등 그래프의 세부적인 요소들을 조절해서 테마로 저장할 수 있습니다.&lt;/p&gt;

&lt;p&gt;기본적으로 ggplot2에서 제공하는 테마들도 있고 패키지로 배포되는 테마들도 있습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dia_bar &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;diamonds&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;cut&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;cut&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_bar&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; theme_gray&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/tqhivmv0cc9yf2u/unnamed-chunk-5-1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; theme_bw&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/hpdtj4mpleh01da/unnamed-chunk-5-2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; theme_classic&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/8yr132sms91n5za/unnamed-chunk-5-3.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;ggthemes&lt;/code&gt;패키지를 설치하면 추가적인 ggplot2 테마를 적용할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#install.packages(&amp;#39;ggthemes&amp;#39;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggthemes&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; theme_economist&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; scale_colour_economist&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/34nrv61ywsi483u/unnamed-chunk-6-1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; theme_excel&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/wad7ly0io29mpvx/unnamed-chunk-6-2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; theme_solarized&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/rbb51wi0lcq41hg/unnamed-chunk-6-3.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;세 번에 걸쳐 ggplot2를 사용하는 방법을 설명하면서 ggplot2의 다양한 기능과 적용 방법에 대해 알아보았습니다.
기본적인 사용 방법을 익힌 후에 실제 데이터를 가지고 직접 데이터를 그려보면 생각했던 것 보다 원하는 그래프를 얻는 것이 힘들다는 것을 알게 됩니다.
하지만 ggplot2에 어느 정도의 데이터 정제 능력이 뒷받침된다면 많은 문제들을 해결해 가면서 원하는 시각화를 구현할 수 있을 거라고 생각합니다.
이후의 ggplot2 관련 글들은 ggplot2와 기타 다른 패키지들을 이용해서 시각화를 시도하고, 발생하는 문제의 원인을 파악해서 해결하는 과정을 보여드리게 될 것 같습니다.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;http://lumiamitie.github.io/r/visualization/ggplot2-03&quot;&gt;ggplot2 - 03&lt;/a&gt; was originally published by Minho Lee at &lt;a href=&quot;http://lumiamitie.github.io&quot;&gt;lmnsh&lt;/a&gt; on August 26, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[ggplot2 - 02 Drawing Graphs]]></title>
  <link>http://lumiamitie.github.io/r/visualization/ggplot2-02</link>
  <id>http://lumiamitie.github.io/r/visualization/ggplot2-02</id>
  <published>2015-08-17T00:00:00+09:00</published>
  <updated>2015-08-17T00:00:00+09:00</updated>
  <author>
    <name>Minho Lee</name>
    <uri>http://lumiamitie.github.io</uri>
    <email>lumiamitie@email.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;img src=&quot;../../../images/taking-notes.jpg&quot; alt=&quot;cover-image&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;ggplot2&quot;&gt;ggplot2&lt;/h2&gt;

&lt;p&gt;저번 글에서는 ggplot2가 어떻게 동작하는지를 위주로 살펴보았습니다. 이번에는 그래프가 에러없이 뜨는데 만족하지 않고 원하는 형태로 그래프를 만들 수 있도록 다른 옵션들을 조작하는 방법을 살펴보겠습니다. &lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
iris_plot &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; iris&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Sepal.Length&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Sepal.Width&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;parameter&quot;&gt;Parameter&lt;/h4&gt;

&lt;p&gt;parameter를 추가하면 geom의 형태를 변경하거나 stat이 적용되는 방법을 바꿀 수 있습니다. 에스테틱을 직접 적용하거나 각 함수마다 주어지는 옵션을 변경하게 됩니다. 에스테틱은 &lt;strong&gt;aes&lt;/strong&gt;함수 안에서 쓰이면 데이터의 값에 매핑되지만, 밖에서 쓰일 경우에는 해당 요소를 전부 변경합니다. 예를 들어 &lt;code&gt;geom_point(aes(size = var))&lt;/code&gt;은 &lt;strong&gt;var&lt;/strong&gt; 데이터의 값에 따라 점의 크기가 변하게 됩니다. 하지만 &lt;code&gt;geom_point(size = 3)&lt;/code&gt; 의 경우에는 모든 점의 크기가 3으로 고정됩니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;iris_plot &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;size &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_smooth&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/7ekhiqufhbze3bi/unnamed-chunk-2-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;에스테틱 중에서 좌표를 나타내는 &lt;strong&gt;x&lt;/strong&gt;와 &lt;strong&gt;y&lt;/strong&gt;를 제외하면&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;colour&lt;/strong&gt;(또는 color)는 점이나 선 색상이나 면의 테두리 색을 결정합니다&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;fill&lt;/strong&gt;은 면의 색상을 결정합니다&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;alpha&lt;/strong&gt;는 색의 투명도를 나타냅니다&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;에스테틱은 아니지만 각 함수의 세부적인 내용을 조정하는 parameter들도 존재합니다.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;geom_smooth&lt;/strong&gt;의 경우에는 &lt;code&gt;method = &amp;#39;lm&amp;#39;&lt;/code&gt;으로 지정하면 추세선을 직선으로 그려줍니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;iris_plot &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;size &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_smooth&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;method &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;lm&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/3qgmefpww21h7wz/unnamed-chunk-3-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;strong&gt;linetype&lt;/strong&gt; 옵션은 선의 모양을 변경할 수 있게 합니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;iris_plot &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;size &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_smooth&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;linetype &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/g62ytcfxbh50um6/unnamed-chunk-4-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;strong&gt;se&lt;/strong&gt; 옵션을 끄면 standard error의 범위를 표현하지 않습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;iris_plot &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;size &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_smooth&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;se &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/9aeal2qtwr59me6/unnamed-chunk-5-1.png?dl=0&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;각각의 함수들에는 적용할 수 있는 다양한 parameter들이 있습니다. 각 parameter들에 대한 자세한 설명은 역시 &lt;a href=&quot;http://docs.ggplot2.org/current/&quot;&gt;이 곳&lt;/a&gt;의 링크로 남겨놓는 편이 좋겠네요. 아직 이번 1월에 업데이트된 공식 1.0.0 버전에 추가된 내용은 반영되지 않은 것 같습니다만, 그래도 상당히 많은 예제를 볼 수 있습니다. &lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;h3 id=&quot;position-adjustment&quot;&gt;Position Adjustment&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;position&lt;/strong&gt;은 &lt;strong&gt;geom&lt;/strong&gt;이 보여지는 형태를 바꿉니다. 막대그래프라면 막대가 누적으로 쌓일지, 옆에 나란히 놓일지 결정할 수 있습니다. 산점도라면 여러 점들이 겹쳐있을때 각 좌표에 일정 난수를 더해서 흩어져보이게 만들 수도 있습니다. &lt;/p&gt;

&lt;hr&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;displ&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; hwy&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;jitter&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_smooth&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/z4hsb5vuzc2uxnf/unnamed-chunk-6-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;strong&gt;position = &amp;lsquo;jitter&amp;rsquo;&lt;/strong&gt;를 적용하면 각 x,y값에 난수를 더해서 점이 겹치지 않도록 합니다. &lt;code&gt;geom_point(position=&amp;#39;jitter&amp;#39;)&lt;/code&gt;는 &lt;code&gt;geom_jitter()&lt;/code&gt; 로 줄여서 쓸 수 있습니다&lt;/p&gt;

&lt;hr&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;vs&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_bar&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;position&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;stack&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/r168eqbulj7bugh/unnamed-chunk-7-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;막대그래프에서 &lt;strong&gt;position = &amp;#39;stack&amp;rsquo;&lt;/strong&gt;은 각 막대를 쌓아서 누적된 형태로 보여줍니다. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;vs&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_bar&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;position&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;fill&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/zn2um7alzmfq4yx/unnamed-chunk-8-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;strong&gt;position = &amp;#39;fill&amp;rsquo;&lt;/strong&gt;은 비율을 나타내는 누적 막대를 보여줍니다. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;vs&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_bar&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;position&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;dodge&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/1xp7nxxh4xxb3wy/unnamed-chunk-9-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;strong&gt;position = &amp;#39;dodge&amp;rsquo;&lt;/strong&gt;는 각 막대를 옆으로 나열합니다&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;postion을 적용하지 않을 때에는 &lt;strong&gt;position = &amp;#39;identity&amp;rsquo;&lt;/strong&gt; 옵션이 사용됩니다. 기본값이 postion = &amp;#39;identity&amp;#39;인 함수를 사용하고 있다면 position옵션을 생략할 수 있습니다. &lt;/p&gt;

&lt;p&gt;그리고, position을 더 상세하게 지정하고 싶다면 &lt;em&gt;position_옵션이름&lt;/em&gt; 으로 지정된 함수에 parameter를 적용하면 됩니다. &lt;strong&gt;position_dodge&lt;/strong&gt;의 경우에는 어느 정도 간격으로 떨어뜨려 놓을지 정할 수 있고, &lt;strong&gt;position_jitter&lt;/strong&gt;에서는 난수를 어느 정도로 적용할 지 결정할 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dodge &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; position_dodge&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sleep&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ID&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;extra&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; group&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;group&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_line&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; dodge&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; dodge&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fill&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;white&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; shape&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## ymax not defined: adjusting position using y instead
## ymax not defined: adjusting position using y instead
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/ki1n8ebz7aqghgj/unnamed-chunk-10-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;위에서는 &lt;strong&gt;position_dodge&lt;/strong&gt;를 사용하지 않으면 ID=5일 때 점이 겹쳐보입니다. 일부러 점을 떨어져있게 만들고 싶다면 위와 같이 position_dodge 함수를 적용시킬 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;h2 id=&quot;scales&quot;&gt;Scales&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;Scale&lt;/strong&gt;은 데이터의 값이 그래프의 에스테틱에 대입되는 과정을 조절하고 &lt;strong&gt;guide&lt;/strong&gt;(축과 범례 등)가 어떻게 표시되는지 결정한다고 저번 글에서 말씀드렸습니다. 스케일과 관련된 함수는 기본적으로는 &lt;strong&gt;scale_에스테틱_적용방법&lt;/strong&gt;으로 이름이 정해집니다. 스케일을 조절하는 함수는 에스테틱의 종류만큼이나 다양하게 존재하지만, 어느 정도 규칙적인 함수명 덕분에 비교적 쉽게 검색해서 적용이 가능합니다. &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;우선 본격적으로 관련 함수들에 대해서 알아보기 전에 &lt;code&gt;xlim&lt;/code&gt;, &lt;code&gt;ylim&lt;/code&gt; 함수를 살펴보겠습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;displ&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; hwy&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_smooth&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  xlim&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Warning: Removed 153 rows containing missing values (stat_smooth).
## Warning: Removed 153 rows containing missing values (geom_point).
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/zkziiemwfhl3b9y/unnamed-chunk-11-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;strong&gt;xlim()&lt;/strong&gt;, 또는 &lt;strong&gt;ylim()&lt;/strong&gt;함수를 이용하면 화면에 보이는 그래프의 범위를 보여줄 수 있습니다. 화면에 나오지 못하는 데이터가 생긴다면 경고메세지가 발생하지만 그래프는 문제없이 그려집니다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;다음으로는 색상과 관련된 scale에 대해서 살펴보려고 합니다. 아래 예제에서는 fill을 기준으로 설명하겠지만, fill을 colour로 바꾸기만 하면 많은 경우에 동일한 방식으로 적용할 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dia_bar &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;diamonds&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;cut&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;cut&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_bar&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  scale_fill_brewer&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/dgkf9q6grsl8zbg/unnamed-chunk-12-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;strong&gt;xxx_brewer&lt;/strong&gt;로 끝나는 색상관련 scale 함수들은 &lt;strong&gt;RColorBrewer&lt;/strong&gt;패키지를 이용해서 색상을 지정합니다. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;RColorBrewer&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;display.brewer.all&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/iy1yjajlurkmhss/colorbrewer_palette.jpg&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;code&gt;display.brewer.all()&lt;/code&gt; 함수를 통해 사용가능한 색 조합의 이름과 색상들을 살펴볼 수 있습니다. 값의 높고 낮음을 보여줄 수 있는 Sequential, 서로 다른 범주나 그룹들을 구분지어 보여줄 수 있는 Qualitative, 어느 중심 값을 기준으로 얼마나 떨어져 있는지를 보여주는 Diverging 의 순서로 정리가 되어 있습니다. 현재 표현하고자 하는 데이터의 형태를 잘 살펴보고, 적절한 색조합을 적용시키면 됩니다. &lt;/p&gt;

&lt;p&gt;원하는 색조합을 찾았다면, &lt;strong&gt;palette&lt;/strong&gt; 옵션에 조합의 이름을 넣어서 색상을 적용할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  scale_fill_brewer&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;palette &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Paired&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/uizqp3y5iezro0c/unnamed-chunk-14-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  scale_fill_brewer&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;palette &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Accent&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/ewkxls3p3c2d8kt/unnamed-chunk-14-2.png?dl=0&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;다음은 축에 대한 scale함수를 사용해보겠습니다. 연속적인 수치 자료가 y축에 있을 때 스케일은 &lt;strong&gt;scale_y_continuous&lt;/strong&gt;함수를 적용할 수 있습니다. x축이라면 y를 x로 바꾸면 되고, 이산형자료라면 continuous가 discrete로 바뀝니다.&lt;/p&gt;

&lt;p&gt;위에서 &lt;strong&gt;xlim&lt;/strong&gt; 함수를 살펴보았는데요. &lt;strong&gt;scale_x_continuous&lt;/strong&gt; 안에 &lt;strong&gt;limits&lt;/strong&gt; 옵션을 지정하면 동일한 효과를 얻을 수 있습니다. &lt;strong&gt;xlim&lt;/strong&gt;이 적용되었던 예제를 &lt;strong&gt;scale_x_continuous&lt;/strong&gt;로 표현하면 다음과 같습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;displ&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; hwy&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
    geom_point&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
    geom_smooth&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
    scale_x_continuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;limits&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Warning: Removed 153 rows containing missing values (stat_smooth).
## Warning: Removed 153 rows containing missing values (geom_point).
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/t12slazk5s9zigu/unnamed-chunk-15-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;산점도 같은 경우에는 그래프로 표현하는 범위를 강제하더라도 문제가 없겠지만, 막대 그래프 같은 경우에는 위와 같은 방식을 사용하면 막대 자체가 표현이 되지 않을 수 있으니 유의하시기 바랍니다.&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;&lt;strong&gt;trans&lt;/strong&gt;옵션은 변수변환을 스케일 차원에서 조절할 수 있게 해줍니다. &lt;strong&gt;trans = log10&lt;/strong&gt;옵션을 적용하면 y축에 log10 함수를 적용합니다. &lt;strong&gt;scale_y_log10&lt;/strong&gt; 처럼 자주 쓰이는 함수들은 미리 함수들이 지정되어 있기도 하지만 옵션에서 사용하면 사용가능한 함수의 이름을 입력하는 방식으로 사용할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  scale_fill_brewer&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;palette &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Accent&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  scale_y_continuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;trans &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;log10&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/2rc5i9nykl4ycpg/unnamed-chunk-16-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;&lt;strong&gt;breaks&lt;/strong&gt;옵션은 눈금에 표시되는 항목을 지정할 수 있게 해줍니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
scale_y_continuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;breaks &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;15000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/9mvg39iambqj606/unnamed-chunk-17-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;h2 id=&quot;coordinate-system&quot;&gt;Coordinate System&lt;/h2&gt;

&lt;p&gt;좌표계의 경우 아무런 값이 지정되지 않으면 기본값으로 Cartesian을 적용합니다(&lt;strong&gt;coord_cartesian()&lt;/strong&gt;). &lt;strong&gt;coord_flip()&lt;/strong&gt;을 이용해 x축과 y축을 뒤바꿀 수 있고, &lt;strong&gt;coord_polar()&lt;/strong&gt;를 사용하면 극좌표계로 변환시킬 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  coord_flip&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/0phyjtlodcq59s9/unnamed-chunk-18-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  coord_polar&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/hewbz0fx3dywndq/unnamed-chunk-19-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;그래프에서 보이는 축의 범위를 조절하려고 할 때 위에서 했던 대로 scale을 변경할 수도 있지만, 좌표계를 직접 변형시키는 방법이 있습니다. 하지만 두 개의 방식에는 큰 차이가 있는데, scale을 변경하면 해당 스케일을 벗어나는 데이터는 제거하고 그래프를 그립니다. 따라서 boxplot의 경우에는 남아있는 데이터로 box가 새로 그려질 것이고 막대그래프의 경우에는 데이터의 범위를 벗어나는 막대는 막대 자체가 그려지지 않습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# &amp;#39;Ideal&amp;#39;의 막대가 그려지지 않는다&lt;/span&gt;
dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; scale_y_continuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;limits&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;15000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/rwnm8kwmjizzd24/unnamed-chunk-20-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;InsectSprays&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;spray&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;count&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_boxplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  scale_y_continuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;limits&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Warning: Removed 16 rows containing non-finite values (stat_boxplot).
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/knj2j6c1kbre66r/unnamed-chunk-21-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;반면에 좌표를 직접 수정하는 경우에는 그래프를 일단 그린 다음에 입력한 범위만 확대하거나 축소하는 등 변형을 시킵니다. 그래서 그래프의 모양이 변하거나 하지 않습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# &amp;#39;Ideal&amp;#39;의 막대가 그려진다. 대신 15000 이후로는 보이지 않는다&lt;/span&gt;
dia_bar &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  coord_cartesian&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ylim&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;15000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/mczzqqwkc2ne6gi/unnamed-chunk-22-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;InsectSprays&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;spray&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;count&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_boxplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  coord_cartesian&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ylim&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/zkn7vynvxvffm8f/unnamed-chunk-23-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;&lt;strong&gt;coord&lt;/strong&gt; 항목을 신경써서 적용해야 할 때가 또 있습니다. 바로 지도를 그릴 때인데요. 지도를 그릴 때는 기본적으로 위도와 경도가 직교좌표계에 그려지는데, &lt;strong&gt;coord_map()&lt;/strong&gt;을 사용하면 지도의 투영 방식을 적용하여 ggplot 그래프를 그릴 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;maps&lt;/strong&gt; 패키지에서 지도를 받아온 후에 좌표계를 지정하지 않고 그려보겠습니다. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;maps&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
asia &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; map_data&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;world&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; region &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;Japan&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;China&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;North Korea&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;South Korea&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;asia&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; long&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; lat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; group &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; group&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_polygon&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;white&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;black&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/n6lpkedji83z88y/unnamed-chunk-24-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;다음은 &lt;strong&gt;coord_map&lt;/strong&gt; 함수를 사용합니다. 기본 투영법은 &lt;strong&gt;mercator&lt;/strong&gt;입니다. 위도선이 나타나는 간격이 달라지는 것을 볼 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;asia&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; long&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; lat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; group &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; group&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_polygon&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;white&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;black&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  coord_map&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/w2cvqrzyjyrqt19/unnamed-chunk-25-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;&lt;strong&gt;?mapproject&lt;/strong&gt;을 통해서 적용할 수 있는 다양한 투영법과 적용할 수 있는 옵션을 찾아볼 수 있습니다. 아래에서는 그 중 몇 가지만 함께 살펴보도록 하겠습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;asia&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;long&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; group &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; group&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_polygon&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;white&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;black&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  coord_map&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;orthographic&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/71v6llv6xhk7rh5/unnamed-chunk-26-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;asia&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;long&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; group &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; group&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_polygon&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;white&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;black&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  coord_map&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;polyconic&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/20fhdtnsh0wi3ki/unnamed-chunk-27-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;h2 id=&quot;facetting&quot;&gt;Facetting&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;facet&lt;/strong&gt;을 적용하면 데이터의 부분집합들을 하위 그래프로 분리해서 그릴 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;facet_wrap()&lt;/strong&gt;을 사용하면 하위 그래프들이 수평으로 나열되고, &lt;strong&gt;facet_grip()&lt;/strong&gt;은 수직과 수평으로 각각 다른 변수를 지정할 수 있습니다. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mtc_point &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mpg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; wt&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

mtc_point &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  facet_wrap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/6dun5dpe0p4bg7s/unnamed-chunk-28-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;두 개 이상의 변수를 동시에 지정하면 각 변수들의 경우의 수에 맞게 그래프를 그려줍니다.&lt;/p&gt;

&lt;p&gt;이렇게 많은 숫자의 그래프가 그려질 때 &lt;strong&gt;ncol&lt;/strong&gt; 옵션을 이용하면 한 열에 보여질 그래프의 개수를 조정할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mtc_point &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  facet_wrap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;cyl&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;gear&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ncol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/zk1ot342brer6ft/unnamed-chunk-29-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mtc_point &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  facet_grid&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gear&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/vxdhqg1qsxvrf20/unnamed-chunk-29-2.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;&lt;strong&gt;facet_wrap&lt;/strong&gt;의 경우에는 scales 옵션을 이용하면 각 그래프의 축을 고정시킬지 그래프별로 다르게 할지 결정할 수 있습니다. &lt;/p&gt;

&lt;p&gt;&lt;strong&gt;scales = &amp;#39;fixed&amp;rsquo;&lt;/strong&gt;는 각 그래프 모두 축이 일정하게 그려집니다.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;scales = &amp;#39;free&amp;rsquo;&lt;/strong&gt;는 각 그래프의 데이터 범위에 맞게 조정해서 그립니다.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;scales = &amp;#39;free_x&amp;rsquo;&lt;/strong&gt;는 x축은 데이터 범위에 맞게 조절하고, y축은 고정시킵니다. &lt;strong&gt;&amp;#39;free_y&amp;rsquo;&lt;/strong&gt; 옵션도 마찬가지로 사용할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mtc_point &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  facet_wrap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; scales &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;fixed&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/xs5ig7n0akbigg6/unnamed-chunk-30-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mtc_point &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  facet_wrap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; scales &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;free&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/kf5uxcx7zj7m3x8/unnamed-chunk-30-2.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mtc_point &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  facet_wrap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; scales &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;free_x&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/zk2hmlf30wbmn79/unnamed-chunk-30-3.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;&lt;strong&gt;facet_grid&lt;/strong&gt;에서도 마찬가지로 &lt;strong&gt;scales&lt;/strong&gt; 옵션에  &lt;strong&gt;&amp;#39;free&amp;rsquo;&lt;/strong&gt; 나 &lt;strong&gt;&amp;#39;free_x&amp;rsquo;, &amp;#39;free_y&amp;rsquo;&lt;/strong&gt; 등을 적용할 수 있습니다. &lt;strong&gt;facet_grid&lt;/strong&gt;에서는 추가적으로 &lt;strong&gt;space&lt;/strong&gt; 옵션을 추가할 수 있는데, 기본적으는 각 그래프의 크기가 동일하게 그려지지만, &lt;strong&gt;space = &amp;#39;free&amp;rsquo;&lt;/strong&gt; 옵션이 지정되면 데이터의 범위에 따라 그래프의 크기도 변경됩니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mtc_point &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  facet_grid&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gear&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; scales &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;free_x&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/t6pzux5aiy8y7yr/unnamed-chunk-31-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mtc_point &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  facet_grid&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gear&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; scales &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;free&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/5h7fd25nbd9egy0/unnamed-chunk-31-2.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mtc_point &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  facet_grid&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gear&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; scales &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;free&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; space &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;free&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/gz6j6faugpkel0u/unnamed-chunk-31-3.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;여기까지 해서 ggplot 객체를 구성하는 layer, scale, coord, facet까지 훑어보았습니다. 이제 어느 정도 원하는 대로 ggplot 그래프를 그릴 수 있게 되었습니다. 다음 글에서는 ggplot 그래프에 저장된 테마를 적용하는 방법과 &lt;strong&gt;stat&lt;/strong&gt;이 생성하는 변수 등 앞에서 제대로 다루지 않았던 항목들을 살펴보려고 합니다.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;http://lumiamitie.github.io/r/visualization/ggplot2-02&quot;&gt;ggplot2 - 02 Drawing Graphs&lt;/a&gt; was originally published by Minho Lee at &lt;a href=&quot;http://lumiamitie.github.io&quot;&gt;lmnsh&lt;/a&gt; on August 17, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[ggplot2 - 01 Grammar of Graphics]]></title>
  <link>http://lumiamitie.github.io/r/visualization/ggplot2-01</link>
  <id>http://lumiamitie.github.io/r/visualization/ggplot2-01</id>
  <published>2015-08-14T00:00:00+09:00</published>
  <updated>2015-08-14T00:00:00+09:00</updated>
  <author>
    <name>Minho Lee</name>
    <uri>http://lumiamitie.github.io</uri>
    <email>lumiamitie@email.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;img src=&quot;../../../images/desk-pen-ruler.jpg&quot; alt=&quot;cover-image&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;ggplot2&quot;&gt;ggplot2&lt;/h2&gt;

&lt;p&gt;몇 번의 포스팅을 거쳐서 &lt;strong&gt;ggplot2&lt;/strong&gt;의 원리와 사용법에 대해서 이야기해보려고 합니다. &lt;strong&gt;ggplot2&lt;/strong&gt;는 분명 아무것도 모르고 접근하기에는 어느 정도 진입장벽이 있는 패키지라고 생각합니다. 받아들이는 데이터의 형식이 정해져 있고, 단순한 산점도나 막대그래프를 그릴 때에도 요소들을 맵핑하고 레이어를 얹어주는 작업을 해주어야 합니다. 그리고 함수나 옵션들이 굉장히 많기 때문에 무작정 패키지를 배워보겠다고 tutorial을 찾아보다가는 길을 잃어버릴 수도 있습니다. 하지만 &lt;strong&gt;ggplot2&lt;/strong&gt;는 그 일관적인 체계 덕분에 더 강력한 힘을 발휘합니다. 일단 그 구조를 이해하게 되면 처음 시도해보는 시각화 방식도 무리없이 적용해 볼 수 있습니다. 또, input 데이터의 형식이 일정하기 때문에 다양한 형태의 차트를 일정한 형태의 문법으로 데이터의 변경을 최소화시키면서 만들어 볼 수 있습니다. &lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;data-to-graph&quot;&gt;Data to Graph&lt;/h2&gt;

&lt;p&gt;데이터를 통해 그래프를 그리는 과정은 다시 말하면 &lt;strong&gt;데이터의 속성을 그래프의 시각적인 속성에 대입(대응)시키는 것&lt;/strong&gt;입니다.&lt;/p&gt;

&lt;p&gt;예를 들어, 시계열 자료인 종합주가지수를 그래프로 그린다고 해보겠습니다. 시간에 따른 시계열 변화를 선그래프로 표현해보려고 합니다. 이 때 &lt;em&gt;시간&lt;/em&gt;이라고 하는 변수는 그래프에서 &lt;em&gt;X축&lt;/em&gt;에 대입된다면,  &lt;em&gt;수치(연속형)형 자료&lt;/em&gt;인 종합주가지수는 Y축에 대응됩니다. 한국과 일본의 주가지수를 비교해 볼 수도 있을 텐데요. 이 경우에 &lt;em&gt;국가&lt;/em&gt;라는 변수는 서로 다른 직선으로 표현되어야 하는데, &lt;em&gt;색상&lt;/em&gt;을 다르게 주거나 &lt;em&gt;선의 형태&lt;/em&gt;를 실선/점선으로 구분하여 국가를 구분해서 보여줄 수 있습니다.&lt;/p&gt;

&lt;p&gt;R에서 기본적으로 제공하는 그래픽 함수들은 &lt;strong&gt;사용하기가 편리합니다&lt;/strong&gt;. 물론 이것은 상황에 따라서 달라지긴 하겠지만 iris 데이터의 Scatter plot matrix는 &lt;code&gt;plot(iris)&lt;/code&gt; 라는 짧은 한 줄짜리 코드로 실행시킬 수 있습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/1ipfctira06226k/unnamed-chunk-1-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;그리고 &lt;strong&gt;plot&lt;/strong&gt; 함수는 어느 정도 데이터의 형태를 확인해서 그에 적합한 시각화 방식을 제공합니다. &lt;code&gt;plot(Nile)&lt;/code&gt;의 경우에는 시계열 자료라는 특성에 맞게 시간에 따른 선그래프를 그려줍니다&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/opjrx2aa32u6l8v/unnamed-chunk-2-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;이처럼 R이 기본적으로 제공하는 그래픽 함수들은 간편하게 그래프를 그릴 수 있게 해줍니다. 그렇다면 이 함수들은 무엇이 문제일까요. 실제로 데이터를 가지고 그래프를 그려보겠습니다.&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;R에서 기본으로 제공하는 데이터는 &lt;code&gt;data()&lt;/code&gt;로 확인할 수 있습니다. 기본 데이터 중에서 &lt;code&gt;BOD&lt;/code&gt; 데이터를 가지고 막대그래프와 선그래프를 그려보려고 합니다. &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;BOD&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/9pdezafx0rnmdao/unnamed-chunk-3-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;&lt;strong&gt;plot&lt;/strong&gt;함수로 그려놓고 보니 우리가 원하던 선의 형태가 아닙니다. 선 모양으로 강제하기 위해서는 &lt;code&gt;type = &amp;#39;l&amp;#39;&lt;/code&gt;옵션을 추가해 주어야 합니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;BOD&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; type &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;l&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/noae829euaorw2i/unnamed-chunk-4-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;선 그래프를 완성했습니다. 그러면 이번에는 막대그래프를 그려보려고 합니다. 막대그래프를 그리려면 &lt;strong&gt;barplot&lt;/strong&gt; 함수를 사용해야 합니다.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;barplot(BOD)&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;실행시켜보면 에러 메세지가 뜹니다. &lt;em&gt;&amp;lsquo;height&amp;#39;는 반드시 벡터 또는 행렬이어야 합니다&lt;/em&gt; 라는 메세지가 나옵니다.&lt;/p&gt;

&lt;p&gt;그러면 행렬로 데이터를 변환시킨 후에 사용해 보겠습니다. &lt;strong&gt;as.matrix()&lt;/strong&gt;를 사용합니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;barplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;as.matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;BOD&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/mbt3zkp8blokmn8/unnamed-chunk-5-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;이번에도 원하는 모양의 그래프가 나오지 않았습니다. 행렬로 변환은 시켰는데 행과 열이 뒤바뀐 것 같습니다. 행과 열을 뒤바꾸려면 함수 &lt;strong&gt;t&lt;/strong&gt; (transpose) 를 사용하면 됩니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;barplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;as.matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;BOD&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/18htgjdz7242tnj/unnamed-chunk-6-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;그려놓고 보니 생각지도 않던 누적 막대 그래프입니다. &lt;strong&gt;plot&lt;/strong&gt; 함수는 알아서 &lt;em&gt;Time&lt;/em&gt; 변수를 X축으로 인식했는데 &lt;strong&gt;barplot&lt;/strong&gt;은 그렇지 않은 것 같습니다. 우리는 &lt;strong&gt;demand&lt;/strong&gt; 변수만을 높이로 해서 막대를 그리면 되기 때문에 아래와 같이 그래프를 완성하겠습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;barplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;BOD&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;demand&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/qk1ym8fw6a2x2ue/unnamed-chunk-7-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;여기까지의 과정을 살펴보겠습니다. 분명 각각의 그래프를 그릴 때에는 정말 단순한 코드로 괜찮은 그래프를 쉽게 얻을 수 있었습니다. 하지만 문제는 선그래프를 그리고나서 동일한 데이터의 막대그래프를 그릴 때인데요. 완전히 다른 함수에, 받아들이는 데이터의 형태도 다르면서, 내부의 옵션들 또한 내용이 많이 다릅니다. 각각의 함수는 쉽게 사용할 수 있다고 하지만, 새로운 그래프를 그리려면 매번 처음부터 공부를 해야할 것 같습니다. &lt;/p&gt;

&lt;p&gt;또, 위에서 보이지는 않았지만 &lt;strong&gt;lines&lt;/strong&gt;, &lt;strong&gt;points&lt;/strong&gt;, &lt;strong&gt;abline&lt;/strong&gt; 등의 함수를 이용해 그래프를 겹쳐서 그리다가 실수라도 할 경우에는 low level 함수인 &lt;strong&gt;plot&lt;/strong&gt;부터 다시 그려야 합니다. 차트가 복잡해지고 다양한 시각화를 원할 수록 기본 그래픽 함수는 답답해 질 수 있습니다.&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;그렇다면 동일한 데이터를 &lt;strong&gt;ggplot2&lt;/strong&gt;를 이용해 막대와 선 그래프를 그려보겠습니다. 각 문법에 대한 자세한 설명은 뒤에서 다룰 것이기 때문에, 여기서는 선과 막대를 그릴 때 코드가 어떻게 달라지는지를 중점적으로 살펴보면 됩니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; BOD&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Time&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;demand&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_line&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/li7kykyxoey9wxt/unnamed-chunk-8-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; BOD&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Time&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;demand&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
    geom_bar&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;stat&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;identity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/jlh5181l0vqexud/unnamed-chunk-8-2.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;ggplot2를 이용해서 그래프를 그릴 경우에는 데이터를 변형시키지 않고도 다양한 방식으로 그래프를 그릴 수 있습니다. 그리고 일정한 문법구조와 비슷한 옵션들을 가지고 있기 때문에 새로운 시각화를 할 때의 비용이 적습니다. &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ggplot2가-그래프를-그리는-방식&quot;&gt;ggplot2가 그래프를 그리는 방식&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/cojet1wx2b8wiji/unnamed-chunk-9-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;&lt;strong&gt;iris&lt;/strong&gt; 데이터에서 &lt;em&gt;Sepal.Length&lt;/em&gt;와 &lt;em&gt;Sepal.Width&lt;/em&gt; 데이터로 산점도를 그린 후에 &lt;em&gt;Species&lt;/em&gt;변수에 따라 색상을 달리하여 ggplot2 그래프를 그려보았습니다. 여기서 ggplot2 그래프의 구성을 그림으로 살펴보면 다음과 같습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/l1aqw8wzwebawai/ggplot2_structure.PNG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;h4 id=&quot;1.-data&quot;&gt;1. Data&lt;/h4&gt;

&lt;p&gt;그래프를 그리려는 데이터는 &lt;strong&gt;iris&lt;/strong&gt;로 결정했습니다. 데이터 내의 변수는 데이터 프레임의 열로 저장되어 있어야 합니다.&lt;/p&gt;

&lt;p&gt;ggplot2가 요구하는 형태(Tidy data)에 대한 자세한 내용은 다음 &lt;a href=&quot;http://vita.had.co.nz/papers/tidy-data.pdf&quot;&gt;문서&lt;/a&gt;에서 확인할 수 있습니다.&lt;/p&gt;

&lt;hr&gt;

&lt;h4 id=&quot;2.-mapping&quot;&gt;2. Mapping&lt;/h4&gt;

&lt;p&gt;그러면, 데이터의 요소와 그래프의 요소를 대응시키는 과정이 발생합니다. 여기서 &lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Sepal.Length&lt;/strong&gt; - &lt;strong&gt;X축&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Sepal.Width&lt;/strong&gt; - &lt;strong&gt;Y축&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Species&lt;/strong&gt; - &lt;strong&gt;점의 색상&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;이 대응됩니다. 여기서 대응은 무조건 1:1로 대응될 필요는 없고, 그리려고 하는 그래프가 필수적으로 요구하는 대응요소만 만족시키면 됩니다. 하나의 변수가 여러 가지 시각적 요소(ggplot2에서는 이것을 에스테틱 &lt;em&gt;Aesthetic&lt;/em&gt; 이라고 합니다)에 대응될 수도 있습니다.&lt;/p&gt;

&lt;hr&gt;

&lt;h4 id=&quot;3.-geometric-object&quot;&gt;3. Geometric Object&lt;/h4&gt;

&lt;p&gt;그리고 나면 어떤 형태의 그래프를 그릴지 지정해야 합니다. ggplot2에서는 이것을 Geometric Object, 줄여서 &lt;strong&gt;geom&lt;/strong&gt;이라고 합니다. 여기서는 산점도(Scaterplot)를 그렸는데, ggplot2에서는 &lt;strong&gt;geom_point&lt;/strong&gt; 함수를 사용합니다. &lt;/p&gt;

&lt;hr&gt;

&lt;h4 id=&quot;4.-position&quot;&gt;4. Position&lt;/h4&gt;

&lt;p&gt;그래프의 형태를 지정했으면 그래프에서 각 도형이 어떤 식으로 배치될 지를 결정할 수 있습니다. 이 옵션이 바로 &lt;strong&gt;position&lt;/strong&gt;입니다. 막대그래프나 선 그래프라면 누적 그래프를 그리거나 할 때 &lt;strong&gt;position&lt;/strong&gt; 옵션을 조정해서 형태를 바꿀 수 있습니다. 여기서는 특별한 배치가 필요없기 때문에 그대로(&amp;#39;identity&amp;rsquo;) 배치합니다. &lt;/p&gt;

&lt;hr&gt;

&lt;h4 id=&quot;5.-statistical-transformation&quot;&gt;5. Statistical Transformation&lt;/h4&gt;

&lt;p&gt;마지막으로 값이 어떻게 그래프에 반영되는지 결정하는 옵션이 있습니다. &lt;em&gt;Statistical Transformation&lt;/em&gt;, 줄여서 &lt;strong&gt;stat&lt;/strong&gt; 옵션입니다. 히스토그램과 같이 구간내에 존재하는 값의 개수를 세거나 밀도를 계산하는 등, 주어진 값을 변형시켜서 그래프에 반영시킬 때 사용합니다. 여기서는 특별한 변환 없이 값을 그대로(&amp;#39;identity&amp;rsquo;) 사용합니다.&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ggplot2의-구성&quot;&gt;ggplot2의 구성&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/jr287jjnm0l6qhq/ggplot2_structure2.PNG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;p&gt;위에서 살펴본 다섯 가지 구성 요소들은 하나의 레이어를 구성합니다. 그리고 하나 이상의 레이어만 구성되면 &lt;strong&gt;ggplot2&lt;/strong&gt;는 우리에게 그래프를 출력합니다. 레이어 이외에 ggplot2의 그래프를 구성하는 요소는 &lt;strong&gt;Scale&lt;/strong&gt;, &lt;strong&gt;Coordinate System&lt;/strong&gt;, &lt;strong&gt;Facet&lt;/strong&gt;, &lt;strong&gt;Guide&lt;/strong&gt;가 있습니다. &lt;/p&gt;

&lt;hr&gt;

&lt;h4 id=&quot;scale&quot;&gt;Scale&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;Scale&lt;/strong&gt;은 데이터의 값이 그래프의 에스테틱에 대입되는 과정을 조절하고 &lt;strong&gt;guide&lt;/strong&gt;(축과 범례 등)가 어떻게 표시되는지 결정합니다. 보통은 &lt;strong&gt;ggplot2&lt;/strong&gt;가 알아서 scale을 추가하지만 원하는 사항에 대해서는 명시해 주면 그래프에 반영시킬 수 있습니다. &lt;strong&gt;scale&lt;/strong&gt;을 조절하면 &lt;strong&gt;log&lt;/strong&gt;나 &lt;strong&gt;sqrt&lt;/strong&gt; 등의 변수 변환을 &lt;strong&gt;ggplot2&lt;/strong&gt; 상에서 할 수 있고, &lt;em&gt;fill&lt;/em&gt;이나 &lt;em&gt;colour&lt;/em&gt; 등의 에스테틱에서 색상을 사용자가 지정할 수 있게 됩니다.&lt;/p&gt;

&lt;hr&gt;

&lt;h4 id=&quot;coordinate-system&quot;&gt;Coordinate System&lt;/h4&gt;

&lt;p&gt;여기서는 좌표를 결정하는 에스테틱들이 어떻게 연결되는지를 결정합니다. 기본값은 직교좌표계(Cartesian)로 지정되어 있습니다. &lt;strong&gt;stat&lt;/strong&gt;과 &lt;strong&gt;geom&lt;/strong&gt;이 결정되면 좌표계를 변경할 수 있습니다. 또, Cartesian에서 x축과 y축을 바꾸는 것도 이 부분에서 변경할 수 있습니다. &lt;/p&gt;

&lt;hr&gt;

&lt;h4 id=&quot;facet-specification&quot;&gt;Facet Specification&lt;/h4&gt;

&lt;p&gt;데이터를 특정 변수를 기준으로 하는 부분집합들로 쪼개서 &lt;strong&gt;small multiple&lt;/strong&gt;의 형태로 그릴 수 있게 합니다. &lt;strong&gt;iris&lt;/strong&gt; 데이터를 기준으로 말하자면, 위에서 했던 것처럼 색상으로 구분하지 않고 Species별로 각각의 그래프를 따로 그리게 됩니다.&lt;/p&gt;

&lt;hr&gt;

&lt;h4 id=&quot;guides&quot;&gt;Guides&lt;/h4&gt;

&lt;p&gt;가이드는 그래프를 보는 사람이 그래프의 시각적인 속성들을 어떻게 데이터와 연관지어서 볼 수 있는지 안내하는 역할을 합니다. 눈금을 표시하고 축에 이름표를 달거나 범례를 작성하는 등 그래프를 보고 데이터를 떠올리는 데 도움을 주는 항목들입니다. &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;결국 ggplot2의 그래프는&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Layer + Scale + Coordinate System + (Facet) + (Guide)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;의 형태로 결정이 됩니다. Scale과 Coord 도 사실은 기본값이 주어져 있기 때문에, Layer에만 신경써도 어느 정도 원하는 그래프를 얻을 수 있습니다. &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ggplot2-그래프-그리기&quot;&gt;ggplot2 그래프 그리기&lt;/h2&gt;

&lt;h4 id=&quot;ggplot2::layer&quot;&gt;ggplot2::layer&lt;/h4&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  layer&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; iris&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        mapping &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Sepal.Length&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Sepal.Width&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Species&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        geom &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;point&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        stat &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;identity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;identity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/v45v14nafasz828/unnamed-chunk-10-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;h4 id=&quot;shortcut&quot;&gt;Shortcut&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;layer&lt;/strong&gt; 함수를 이용하면 그래프를 그리는데 필요한 요소들을 레이어에 대입시켜서 원하는 그래프를 얻을 수 있습니다. 하지만 실제로 사용할 때는 자주 사용하는 요소들을 묶어서 미리 만들어놓은 함수들을 사용하게 됩니다.
아래 코드는 위에서 &lt;strong&gt;layer&lt;/strong&gt;함수를 사용했을 때와 같은 결과물을 나타냅니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; iris&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Sepal.Length&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Sepal.Width&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Species&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/crknc2q35qyclzp/unnamed-chunk-11-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;strong&gt;geom_point&lt;/strong&gt;는 &lt;code&gt;geom=&amp;#39;point&amp;#39;&lt;/code&gt;, &lt;code&gt;stat=&amp;#39;identity&amp;#39;&lt;/code&gt;, &lt;code&gt;position=&amp;#39;identity&amp;#39;&lt;/code&gt;가 기본값으로 정해져 있는 함수입니다. 이러한 shortcut 들을 사용하여 더 편리하게 그래프를 그릴 수 있습니다. &lt;/p&gt;

&lt;hr&gt;

&lt;h4 id=&quot;multiple-layers&quot;&gt;Multiple Layers&lt;/h4&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; iris&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Sepal.Length&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Sepal.Width&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_smooth&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; iris&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Sepal.Length&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Sepal.Width&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/yo47zyuwb7yh9dv/unnamed-chunk-12-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;이와 같이 여러개의 레이어를 중복시켜서 그릴 수도 있습니다. 이 때, 공통적으로 반영되는 요소들은 미리 &lt;strong&gt;ggplot()&lt;/strong&gt; 안에 정의해두면 geom이나 stat을 추가할 때 자동적으로 상속받게 됩니다. 또, ggplot을 이용해 만든 결과물은 객체로 저장할 수 있습니다. Mapping되는 부분까지만 객체로 저장해두고 다양한 차트를 그려보는 것도 가능합니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;iris_plot &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; iris&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Sepal.Length&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Sepal.Width&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

iris_plot &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_smooth&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/0gwj3prrdoqndse/unnamed-chunk-13-1.png?dl=0&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ggplot2를 소개하는 첫 번째 글에서는 Grammar of Graphic을 기반으로 어떻게 ggplot2가 그래프를 그리는지를 위주로 살펴보았습니다. 다음 글에서는 parameter와 position을 수정하여 그래프의 형태를 변경하고, scale, coord 등을 변경하는 등 그래프에 대해 세밀한 조작을 하는 과정에 대해서 살펴보겠습니다&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;h2 id=&quot;참고자료&quot;&gt;참고자료&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://shop.oreilly.com/product/0636920023135.do&quot;&gt;R Graphics Cookbook&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://docs.ggplot2.org/current/&quot;&gt;http://docs.ggplot2.org/current/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://ggplot2.org/resources/2007-past-present-future.pdf&quot;&gt;http://ggplot2.org/resources/2007-past-present-future.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://ggplot2.org/resources/2007-vanderbilt.pdf&quot;&gt;http://ggplot2.org/resources/2007-vanderbilt.pdf&lt;/a&gt;&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;http://lumiamitie.github.io/r/visualization/ggplot2-01&quot;&gt;ggplot2 - 01 Grammar of Graphics&lt;/a&gt; was originally published by Minho Lee at &lt;a href=&quot;http://lumiamitie.github.io&quot;&gt;lmnsh&lt;/a&gt; on August 14, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Geocoding with R]]></title>
  <link>http://lumiamitie.github.io/r/geocoding-with-r</link>
  <id>http://lumiamitie.github.io/r/geocoding-with-r</id>
  <published>2015-08-14T00:00:00+09:00</published>
  <updated>2015-08-14T00:00:00+09:00</updated>
  <author>
    <name>Minho Lee</name>
    <uri>http://lumiamitie.github.io</uri>
    <email>lumiamitie@email.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;img src=&quot;../../images/rocks-waves.jpg&quot; alt=&quot;cover-image&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;ggmap::geocode-함수를-이용한-지오코딩&quot;&gt;ggmap::geocode 함수를 이용한 지오코딩&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;ggmap&lt;/strong&gt; 패키지에는 &lt;strong&gt;geocode&lt;/strong&gt;라는 함수가 있다&lt;/p&gt;

&lt;p&gt;지명을 인자로 넣어주면 위도와 경도값을 반환해주고, 옵션에 따라 더 많은 정보를 불러오기도 한다&lt;/p&gt;

&lt;p&gt;그런데 언어가 영문으로 고정되어 있기 때문인지 영문지명으로 입력해야 하고 반환되는 값 또한 영문주소가 반환된다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggmap&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Loading required package: ggplot2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;geocode&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;Seoul&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Information from URL : http://maps.googleapis.com/maps/api/geocode/json?address=Seoul&amp;amp;sensor=false
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##       lon      lat
## 1 126.978 37.56654
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;geocode&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;Seoul&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; output&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;latlona&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##       lon      lat            address
## 1 126.978 37.56654 seoul, south korea
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;geocode&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;Seoul&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; output&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;more&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##       lon      lat     type     loctype            address   north   south
## 1 126.978 37.56654 locality approximate seoul, south korea 37.6956 37.4346
##       east     west postal_code     country administrative_area_level_2
## 1 127.1823 126.7968        &amp;lt;NA&amp;gt; south korea                        &amp;lt;NA&amp;gt;
##   administrative_area_level_1 locality street streetNo point_of_interest
## 1                        &amp;lt;NA&amp;gt;    seoul   &amp;lt;NA&amp;gt;       NA              &amp;lt;NA&amp;gt;
##   query
## 1 Seoul
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;아래와 같이 한글로 지명을 입력하면 오류가 난다.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;geocode(&amp;#39;서울&amp;#39;)&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;옵션을 일부 변경하면 한글도 사용할 수 있지 않을까 하고 생각했지만 아직까지는 방법을 찾지 못했다&lt;/p&gt;

&lt;p&gt;한글지명으로 입력하서 한글주소를 반환받으려면 어떻게 해야할까?&lt;/p&gt;

&lt;hr&gt;

&lt;h2 id=&quot;geocoding-with-google-api-(+rvest)&quot;&gt;Geocoding with Google API (+rvest)&lt;/h2&gt;

&lt;p&gt;일단 여기서는 위도와 경도 자료만 가지고 오려고 한다&lt;/p&gt;

&lt;p&gt;&lt;code&gt;http://maps.googleapis.com/maps/api/geocode/xml?sensor=false&amp;amp;language=ko&amp;amp;address=&amp;#39;서울&amp;#39;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;웹브라우저에서 위 url로 들어가보면 xml 데이터를 볼 수 있다&lt;/p&gt;

&lt;p&gt;url 중간에 있는 xml을 json으로 바꿔주면 json 형태의 자료도 받을 수 있다&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;그러면 아래에서는 &lt;code&gt;rvest&lt;/code&gt;패키지를 이용해 위 주소의 xml자료를 가져오고 원하는 항목만 정리해보려고 한다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rvest&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
url &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;http://maps.googleapis.com/maps/api/geocode/xml?sensor=false&amp;amp;language=ko&amp;amp;address=&amp;#39;서울&amp;#39;&amp;quot;&lt;/span&gt;
seoul_xml &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; xml&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; encoding&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;UTF-8&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;

&lt;p&gt;location 태그를 검색하면 하위 항목에 위도, 경도 자료가 있는 것을 볼 수 있다 &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;seoul_xml &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  xml_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;location&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## &amp;lt;location&amp;gt;
##   &amp;lt;lat&amp;gt;37.5665350&amp;lt;/lat&amp;gt;
##   &amp;lt;lng&amp;gt;126.9779692&amp;lt;/lng&amp;gt;
## &amp;lt;/location&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;

&lt;p&gt;아래 처럼 자식항목의 텍스트를 한꺼번에 받아와도 되고&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;seoul_xml &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  xml_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;location&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  xml_children&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  xml_text&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##           lat           lng 
##  &amp;quot;37.5665350&amp;quot; &amp;quot;126.9779692&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;

&lt;p&gt;아래처럼 필요한 항목에 직접 접근해서 받아와도 된다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;seoul_xml &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  xml_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;lat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  xml_text&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] &amp;quot;37.5665350&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;

&lt;p&gt;기본적인 방법을 알았으니 복수의 지명에 대해서 위도/경도 자료를 가지고 오자&lt;/p&gt;

&lt;p&gt;여기서는 우선 지명에 대한 목록을 작성한 후에&lt;/p&gt;

&lt;p&gt;각 지명에 대해 api로 접근해서 위도, 경도값을 받아오고&lt;/p&gt;

&lt;p&gt;이 작업을 for 문을 이용해 반복해서 원하는 결과를 얻으려고 한다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# 위도,경도값을 얻으려고 하는 지명의 목록이다&lt;/span&gt;
loc_list &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;서울&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;대전&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;부산&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# 결과물을 취합하기 위한 빈 벡터&lt;/span&gt;
geocode_result &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;loc &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; loc_list&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# 검색어를 제외한 url&lt;/span&gt;
  url &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;http://maps.googleapis.com/maps/api/geocode/xml?sensor=false&amp;amp;language=ko&amp;amp;address=&amp;#39;&amp;quot;&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# 검색어를 포함시켜서 만든 완전한 url&lt;/span&gt;
  geocode_url &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;paste0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; loc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# url에서 utf-8 인코딩으로 xml자료를 가져온다&lt;/span&gt;
  geocode_xml &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; xml&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;geocode_url&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; encoding&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;UTF-8&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# 위도값을 가져온다&lt;/span&gt;
  geocode_lat &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; geocode_xml &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
    xml_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;lat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
    xml_text&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# 경도값을 가져온다&lt;/span&gt;
  geocode_lon &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; geocode_xml &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
    xml_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;lng&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
    xml_text&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# 지명, 위도, 경도를 1행짜리 데이터 프레임으로 구성한다&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# 이 때 위도,경도값을 숫자로 변환한다&lt;/span&gt;
  geocode_data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;location &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; loc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                            lat &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.numeric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;geocode_lat&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                            lon &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.numeric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;geocode_lon&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                            &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# 최종 결과물이 저장될 오브젝트에 누적시켜서 값을 저장한다&lt;/span&gt;
  geocode_result &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;rbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;geocode_result&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; geocode_data&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
geocode_result
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##   location      lat      lon
## 1     서울 37.56654 126.9780
## 2     대전 36.35041 127.3845
## 3     부산 35.17955 129.0756
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
  &lt;p&gt;&lt;a href=&quot;http://lumiamitie.github.io/r/geocoding-with-r&quot;&gt;Geocoding with R&lt;/a&gt; was originally published by Minho Lee at &lt;a href=&quot;http://lumiamitie.github.io&quot;&gt;lmnsh&lt;/a&gt; on August 14, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[magrittr - Ceci n'est pas une pipe]]></title>
  <link>http://lumiamitie.github.io/r/magrittr</link>
  <id>http://lumiamitie.github.io/r/magrittr</id>
  <published>2015-08-09T00:00:00+09:00</published>
  <updated>2015-08-09T00:00:00+09:00</updated>
  <author>
    <name>Minho Lee</name>
    <uri>http://lumiamitie.github.io</uri>
    <email>lumiamitie@email.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;img src=&quot;../../images/note-and-pen.jpg&quot; alt=&quot;cover-image&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;magrittr&quot;&gt;magrittr&lt;/h2&gt;

&lt;p&gt;dplyr 이후로 Hadley Wickham의 패키지들은 &lt;code&gt;%&amp;gt;%&lt;/code&gt;라는 연산자를 굉장히 많이 사용한다. 파이프 연산자를 사용하면 코드의 가독성을 향상시키면서 생산성도 높이고, 유지 보수에도 굉장히 도움이 많이 된다. 그런데 pipe operator를 모르는 사람에게 코드를 보여주면 코드자체가 암호문으로 변해버리는 단점?이 있었다. 그래서 파이프 연산자의 사용법을 간단하게 설명하면서 &lt;code&gt;magrittr&lt;/code&gt; 패키지의 기능들을 일부 설명해보려고 한다.&lt;/p&gt;

&lt;hr&gt;

&lt;h2 id=&quot;기본적인-pipe의-이용&quot;&gt;기본적인 pipe의 이용&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;fun(x,y,z)&lt;/code&gt;는 &lt;code&gt;x %&amp;gt;% fun(y,z)&lt;/code&gt;와 같다&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;파이프를 기준으로 왼쪽에 있는 오브젝트(또는 연산의 결과물)는 파이프 오른쪽의 연산에 가장 첫 번째 인자로 들어간다. 만약 첫 번째가 아닌 다른 위치로 보내려고 한다면 . 으로 위치를 표시한다. 따라서
&lt;code&gt;y %&amp;gt;% fun(x, ., z)&lt;/code&gt; 도 &lt;code&gt;fun(x, y, z)&lt;/code&gt;와 같다&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;파이프는 연속적으로 적용할 수 있기 때문에 중첩된 함수를 쉽게 표현할 수 있다.
&lt;code&gt;fun3(fun2(fun1(x)))&lt;/code&gt; 은 &lt;code&gt;x %&amp;gt;% fun1 %&amp;gt;% fun2 %&amp;gt;% fun3&lt;/code&gt;과 같다&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr&gt;

&lt;p&gt;실제로 pipe연산이 어떻게 이용되는지 보기 위해서 다음과 같은 연산 과정을 생각해보자&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;iris 데이터에서 Sepal.Length와 Species 열만 선택한다&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Species에 대해 group_by 지정한다&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Sepal.Length의 평균과 표준편차를 계산하여 정규화시킨다&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;계산과정을 위해 생성한 열을 제거한다&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;magrittr&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dplyr&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    group_by&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
      select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;iris&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; Sepal.Length&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; Species&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
      Species&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    sp_mean &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Sepal.Length&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    sp_sd &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; sd&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Sepal.Length&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    norm &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Sepal.Length &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; sp_mean&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; sp_sd
    &lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
  &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;sp_mean&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;sp_sd&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Source: local data frame [150 x 3]
## Groups: Species
## 
##    Sepal.Length Species        norm
## 1           5.1  setosa  0.26667447
## 2           4.9  setosa -0.30071802
## 3           4.7  setosa -0.86811050
## 4           4.6  setosa -1.15180675
## 5           5.0  setosa -0.01702177
## 6           5.4  setosa  1.11776320
## 7           4.6  setosa -1.15180675
## 8           5.0  setosa -0.01702177
## 9           4.4  setosa -1.71919923
## 10          4.9  setosa -0.30071802
## ..          ...     ...         ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;우선 문제가 되는 것은 연산과정에서 맨 먼저 적용되는, 중심 데이터의 위치를 찾기가 어렵다&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;또, 중심이 되는 iris 데이터를 기준으로 해서 함수들이 중첩되어 있다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;그래서 코드를 읽으려면 코드 덩어리에 중심에서부터 한 단계씩 밖으로 나오게 되는데
중심을 기준으로 함수명은 앞에, 옵션은 뒤에 있기 때문에 코드를 보고 내용을 이해하기가 힘들어진다&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;위와 같은 상황에서는 가독성을 위해 코드를 중간중간 끊어서 사용하게 되는데, 
그러면 불필요한 임시변수들이 많이 생길 수 있다&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;위 코드를 pipe를 이용해서 정리하면 다음과 같다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;iris &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Sepal.Length&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; Species&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  group_by&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Species&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sp_mean &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Sepal.Length&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
         sp_sd &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; sd&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Sepal.Length&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
         norm &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Sepal.Length &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; sp_mean&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; sp_sd&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;sp_mean&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;sp_sd&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Source: local data frame [150 x 3]
## Groups: Species
## 
##    Sepal.Length Species        norm
## 1           5.1  setosa  0.26667447
## 2           4.9  setosa -0.30071802
## 3           4.7  setosa -0.86811050
## 4           4.6  setosa -1.15180675
## 5           5.0  setosa -0.01702177
## 6           5.4  setosa  1.11776320
## 7           4.6  setosa -1.15180675
## 8           5.0  setosa -0.01702177
## 9           4.4  setosa -1.71919923
## 10          4.9  setosa -0.30071802
## ..          ...     ...         ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;일단 코드가 훨씬 깔끔하게 정리되었다&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;또 함수와 해당 함수의 옵션 및 추가적인 인수들을 같은 줄에서 관리할 수 있다&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;시작이 되는 데이터가 iris 라는 것이 명확하게 보이고, 우리가 처음에 생각했던 연산 순서대로 함수를 볼 수 있게 되었다&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr&gt;

&lt;p&gt;&lt;code&gt;dplyr&lt;/code&gt; 등의 패키지는 자동으로 &lt;code&gt;%&amp;gt;%&lt;/code&gt; 함수를 불러오기 때문에 &lt;code&gt;magrittr&lt;/code&gt; 패키지를 굳이 불러오지 않더라도 많이 사용하게 되는데 &lt;code&gt;magrittr&lt;/code&gt; 패키지를 불러오면 기본 pipe 이외에도 몇 가지 추가적인 기능을 제공하는 pipe operator와 pipeline을 통한 코드 작성을 도와주는 함수들을 더 제공한다&lt;/p&gt;

&lt;hr&gt;

&lt;h2 id=&quot;다양한-파이프-연산자들&quot;&gt;다양한 파이프 연산자들&lt;/h2&gt;

&lt;h3 id=&quot;&amp;#39;tee&amp;#39;-operator-%t&amp;gt;%&quot;&gt;&amp;lsquo;tee&amp;rsquo; operator %T&amp;gt;%&lt;/h3&gt;

&lt;p&gt;pipe를 기준으로 왼쪽에 있는 연산은 값을 반환하지만 오른쪽에 있는 연산은 값을 반환하지 않는다. 따라서 tee opeator 다음에는 print, plot 등의 함수를 사용해서 연산 중간에 자연스럽게 부수적인 결과물을 출력시킬 수 있다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%T&amp;gt;%&lt;/span&gt;
  print &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1]  0.4826458 -0.8295812  0.1662653  0.0854539  0.9908439
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 0.1791255
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 코드는 표준정규분포를 따르는 난수 5개를 발생시키고&lt;/p&gt;

&lt;p&gt;해당 난수를 print함수를 이용해 출력한 다음에 5개 난수의 평균을 내보낸다.&lt;/p&gt;

&lt;p&gt;rnorm(5)에서 나온 값이 print와 mean에 반영된다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;iris &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%T&amp;gt;%&lt;/span&gt;
  plot &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Sepal.Length&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/iqvk8pznc8r09lv/unnamed-chunk-4-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##   Sepal.Length
## 1          5.1
## 2          4.9
## 3          4.7
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 코드에서는 iris 데이터의 1~3행에 대해서 plot을 그리고 Sepal.Length 열만 선택한다&lt;/p&gt;

&lt;p&gt;plot 함수는 기본적으로 데이터를 반환하지 않기 때문에 pipeline의 중간에 plot을 넣기 위해 tee operator를 사용했다&lt;/p&gt;

&lt;h3 id=&quot;&amp;#39;exposition&amp;#39;-operator-%$%&quot;&gt;&amp;#39;exposition&amp;rsquo; operator %$%&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;with&lt;/code&gt; 함수의 축약버전이다. pipe 기준으로 왼쪽에 있는 오브젝트 내의 name을 pipe 오른쪽의 연산에서 오브젝트 처럼 사용할 수 있게 해준다&lt;/p&gt;

&lt;p&gt;다음 세 가지 코드는 같은 결과물을 출력한다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;cor&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;iris&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;Petal.Length&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; iris&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;Petal.Width&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 0.9628654
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;iris&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
     cor&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Petal.Length&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; Petal.Width&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 0.9628654
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;iris &lt;span class=&quot;o&quot;&gt;%$%&lt;/span&gt;
  cor&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Petal.Length&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; Petal.Width&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 0.9628654
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;compound-assignment-operator-%&amp;lt;&amp;gt;%&quot;&gt;compound assignment operator %&amp;lt;&amp;gt;%&lt;/h3&gt;

&lt;p&gt;chain의 맨 처음에서 사용될 수 있다. pipeline의 결과물을 operator 왼쪽의 오브젝트에 저장한다&lt;/p&gt;

&lt;p&gt;&lt;code&gt;data &amp;lt;- data %&amp;gt;% func1 %&amp;gt;% func2&lt;/code&gt; 는 &lt;code&gt;data %&amp;lt;&amp;gt;% func1 %&amp;gt;% func2&lt;/code&gt; 와 같다&lt;/p&gt;

&lt;p&gt;c(1:10)의 값을 모두 로그변환을 하고 소수점 둘째 자리까지만 남도록 반올림한다면&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;x &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;
x &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##  [1] 0.00 0.69 1.10 1.39 1.61 1.79 1.95 2.08 2.20 2.30
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;x &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;
x &lt;span class=&quot;o&quot;&gt;%&amp;lt;&amp;gt;%&lt;/span&gt; log &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##  [1] 0.00 0.69 1.10 1.39 1.61 1.79 1.95 2.08 2.20 2.30
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;기본연산을-대체하는-함수들&quot;&gt;기본연산을 대체하는 함수들&lt;/h2&gt;

&lt;p&gt;magrittr 패키지에서는 다양한 기본 연산을 pipeline에 쉽게 적용할 수 있도록 다양한 기본 연산에 대한 대체 함수를 제공한다&lt;/p&gt;

&lt;p&gt;예를 들면, &lt;code&gt;iris %&amp;gt;% select(Species)&lt;/code&gt; 는 데이터프레임의 형태로 Species 를 반환하는데
&lt;code&gt;iris$Species&lt;/code&gt; 처럼 단순하게 벡터 형태로 반환해야 한다면
&lt;code&gt;&amp;#39;$&amp;#39;&lt;/code&gt; 함수를 직접 호출하여 이용할 수도 있지만
magrittr의 &lt;code&gt;use_series&lt;/code&gt; 함수를 이용할 수 있다&lt;/p&gt;

&lt;p&gt;따라서 아래 두 연산은 동일하다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mtcars &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span class=&quot;s&quot;&gt;&amp;#39;$&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;mpg&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##  [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2
## [15] 10.4 10.4 14.7 32.4 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4
## [29] 15.8 19.7 15.0 21.4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mtcars &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  use_series&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mpg&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##  [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2
## [15] 10.4 10.4 14.7 32.4 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4
## [29] 15.8 19.7 15.0 21.4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;또 &lt;code&gt;&amp;#39;==&amp;#39;&lt;/code&gt; 연산에 대한 함수로 &lt;code&gt;equals&lt;/code&gt; 함수를 제공한다
결과물이 TRUE, FALSE로 반환되기 때문에 &lt;code&gt;dplyr::filter&lt;/code&gt; 등의 함수에서도 적용할 수 있다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kc&quot;&gt;letters&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  equals&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##  [1]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [12] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [23] FALSE FALSE FALSE FALSE
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mtcars &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; equals&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##     mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## 1  22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## 2  24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
## 3  22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
## 4  32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
## 5  30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
## 6  33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
## 7  21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
## 8  27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
## 9  26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
## 10 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
## 11 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;gcookbook&lt;/code&gt; 패키지의 &lt;code&gt;aapl&lt;/code&gt;데이터에서 2012년의 자료만 필터링하려면 다음과 같이 해볼 수 있다.&lt;/p&gt;

&lt;p&gt;아래 두 가지 방법은 동일한 결과물을 출력한다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gcookbook&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
aapl &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;strftime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;%Y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;2012&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##         date adj_price
## 1 2012-01-06    420.59
## 2 2012-01-13    418.02
## 3 2012-01-20    418.50
## 4 2012-01-27    445.37
## 5 2012-02-03    457.71
## 6 2012-02-10    491.31
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;aapl &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;date &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;strftime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;%Y&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; equals&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2012&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##         date adj_price
## 1 2012-01-06    420.59
## 2 2012-01-13    418.02
## 3 2012-01-20    418.50
## 4 2012-01-27    445.37
## 5 2012-02-03    457.71
## 6 2012-02-10    491.31
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이처럼 다양한 연산에 대한 대체 함수를 이용하면 pipeline 위주로 코드를 작성할 때 도움이 될 수 있다&lt;/p&gt;

&lt;p&gt;함수들의 목록은 다음과 같다&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/hcgg2cwxhct26r1/magrittr_alias.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;함수를 pipe의 형태로 적용하면 중복되는 pipe 연산들에 동시에 적용할 수도 있다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;iris &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  group_by&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Species&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  summarise&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cnt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; n&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Source: local data frame [3 x 2]
## 
##      Species cnt
## 1     setosa  50
## 2 versicolor  50
## 3  virginica  50
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;count_group &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; group_by&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Species&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; summarise&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cnt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; n&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

iris &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  count_group
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Source: local data frame [3 x 2]
## 
##      Species cnt
## 1     setosa  50
## 2 versicolor  50
## 3  virginica  50
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;동일한 연산 과정들이 반복되거나, 구조가 같은 여러 자료에 공통적으로 적용할 수 있는 연산들의 경우에는
이러한 방법으로 함수를 작성하여 반복되는 연산을 간단하게 표현할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;magrittr&lt;/code&gt;패키지에 대해 더 알아보려면 패키지 내에 존재하는 vignette 문서를 살펴보거나 다음
&lt;a href=&quot;http://www.r-statistics.com/2014/08/simpler-r-coding-with-pipes-the-present-and-future-of-the-magrittr-package/&quot;&gt;문서&lt;/a&gt; 등을 읽어보면 보움이 될 것이다&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;http://lumiamitie.github.io/r/magrittr&quot;&gt;magrittr - Ceci n'est pas une pipe&lt;/a&gt; was originally published by Minho Lee at &lt;a href=&quot;http://lumiamitie.github.io&quot;&gt;lmnsh&lt;/a&gt; on August 09, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Mapping with ggplot2+shp]]></title>
  <link>http://lumiamitie.github.io/r/visualization/mapping-with-ggplot2</link>
  <id>http://lumiamitie.github.io/r/visualization/mapping-with-ggplot2</id>
  <published>2015-08-08T00:00:00+09:00</published>
  <updated>2015-08-08T00:00:00+09:00</updated>
  <author>
    <name>Minho Lee</name>
    <uri>http://lumiamitie.github.io</uri>
    <email>lumiamitie@email.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;img src=&quot;../../../images/macphoto.jpg&quot; alt=&quot;cover-image&quot;&gt;
여기서는 shp파일을 불러와서 직접 ggplot2를 이용해 지도를 그리는 방법을 설명하려고 한다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;library(maptools)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Loading required package: sp
## Checking rgeos availability: TRUE
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;library(ggplot2)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;maptools 패키지를 실행시키면 &lt;code&gt;Checking rgeos availability&lt;/code&gt; 라는 문구가 나오는데 여기서 FALSE가 나온다면 rgeos 패키지를 설치해주자&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.diva-gis.org/gdata&quot;&gt;여기 주소&lt;/a&gt;를 통해 한국의 행정구역이 표시된 shp파일을 구해서 데이터를 불러오도록 한다. &lt;strong&gt;Administrative areas&lt;/strong&gt;항목을 다운로드 받는다. 그 중에서 &lt;code&gt;KOR_adm2.shp&lt;/code&gt;파일을 &lt;code&gt;maptools::readShapePoly()&lt;/code&gt;함수로 불러오고, &lt;code&gt;str()&lt;/code&gt; 함수로 데이터를 살펴보자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;shp2 &amp;lt;- readShapePoly(&amp;quot;D:\\data\\gis\\SouthKorea_source\\KOR_adm\\KOR_adm2.shp&amp;quot;)
str(shp2@data)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;  &lt;span class=&quot;c1&quot;&gt;## &amp;#39;data.frame&amp;#39;:  228 obs. of  18 variables:&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; ID_0      &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; int  &lt;span class=&quot;m&quot;&gt;124&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;124&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;124&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;124&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;124&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;124&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;124&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;124&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;124&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;124&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; ISO       &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; Factor w&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; level &lt;span class=&quot;s&quot;&gt;&amp;quot;KOR&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; NAME_0    &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; Factor w&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; level &lt;span class=&quot;s&quot;&gt;&amp;quot;South Korea&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; ID_1      &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; int  &lt;span class=&quot;m&quot;&gt;1591&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1591&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1591&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1591&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1591&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1592&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1592&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1592&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1587&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1588&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; NAME_1    &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; Factor w&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;16&lt;/span&gt; levels &lt;span class=&quot;s&quot;&gt;&amp;quot;Busan&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Chungcheongbuk-do&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;14&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;14&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;14&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;14&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;14&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;15&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;15&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;15&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; ID_2      &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; int  &lt;span class=&quot;m&quot;&gt;19391&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;19392&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;19393&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;19394&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;19395&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;19396&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;19397&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;19398&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;19347&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;19348&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; NAME_2    &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; Factor w&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;208&lt;/span&gt; levels &lt;span class=&quot;s&quot;&gt;&amp;quot;Andong&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Ansan&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;166&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;179&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;191&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;197&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;204&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;34&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;36&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;39&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;186&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;13&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; VARNAME_2 &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; Factor w&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;levels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; NL_NAME_2 &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; Factor w&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;9&lt;/span&gt; levels &lt;span class=&quot;s&quot;&gt;&amp;quot;?? | ??&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;??? |  ???&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; HASC_2    &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; Factor w&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;levels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; CC_2      &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; Factor w&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;levels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; TYPE_2    &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; Factor w&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; levels &lt;span class=&quot;s&quot;&gt;&amp;quot;Gu&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Gun&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Si&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; ENGTYPE_2 &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; Factor w&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; levels &lt;span class=&quot;s&quot;&gt;&amp;quot;City&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;County&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; VALIDFR_2 &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; Factor w&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; level &lt;span class=&quot;s&quot;&gt;&amp;quot;Unknown&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; VALIDTO_2 &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; Factor w&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; level &lt;span class=&quot;s&quot;&gt;&amp;quot;Present&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; REMARKS_2 &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; Factor w&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;levels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; Shape_Leng&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; num  &lt;span class=&quot;m&quot;&gt;1.63&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;12.39&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2.17&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;7.53&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; Shape_Area&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; num  &lt;span class=&quot;m&quot;&gt;0.0809&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.0463&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.06&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.0473&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.0484&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;data_types&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; chr  &lt;span class=&quot;s&quot;&gt;&amp;quot;N&amp;quot;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;C&amp;quot;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;N&amp;quot;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;데이터를 보면 &lt;code&gt;NAME_1&lt;/code&gt; 항목에는 광역시와 도 등 광역단체목록이 담겨있고, &lt;code&gt;NAME_2&lt;/code&gt;에는 시/군 과 서울의 구가 들어있다. &lt;/p&gt;

&lt;p&gt;일단은 shp 데이터를 불러온 것 만으로도 지도의 형태는 살펴볼 수 있다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;plot(shp2)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/qb64zrq2mqrzftt/unnamed-chunk-3-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;code&gt;ggplot2&lt;/code&gt;를 이용해서 지도를 그리려면 이 데이터를 데이터 프레임으로 변경해야 하는데 &lt;code&gt;ggplot2::fortify()&lt;/code&gt; 함수를 이용해서 shp 데이터를 데이터 프레임으로 바꿀 수 있다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;shp2_ffd_noregion &amp;lt;- fortify(shp2)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;head(shp2_ffd_noregion)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##       long      lat order  hole piece group id
## 1 127.5484 35.08423     1 FALSE     1   0.1  0
## 2 127.5519 35.07868     2 FALSE     1   0.1  0
## 3 127.5509 35.07233     3 FALSE     1   0.1  0
## 4 127.5491 35.06628     4 FALSE     1   0.1  0
## 5 127.5443 35.05591     5 FALSE     1   0.1  0
## 6 127.5422 35.04578     6 FALSE     1   0.1  0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이렇게 데이터를 보면 &lt;code&gt;group&lt;/code&gt;과 &lt;code&gt;id&lt;/code&gt;가 숫자로 구분된 것을 볼 수 있는데, 나중에 다른 데이터를 합칠 수 있도록 어떤 변수로 지역을 구분할지 명시할 수 있다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;shp2_ffd &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fortify&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;shp2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; region &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;NAME_1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
shp2_ffd2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fortify&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;shp2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; region &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;NAME_2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;shp2_ffd&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##       long      lat order  hole piece   group    id
## 1 129.0179 35.07678     1 FALSE     1 Busan.1 Busan
## 2 129.0179 35.07653     2 FALSE     1 Busan.1 Busan
## 3 129.0176 35.07653     3 FALSE     1 Busan.1 Busan
## 4 129.0176 35.07625     4 FALSE     1 Busan.1 Busan
## 5 129.0174 35.07625     5 FALSE     1 Busan.1 Busan
## 6 129.0174 35.07597     6 FALSE     1 Busan.1 Busan
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;데이터 프레임으로 구성했으니 ggplot2를 이용해서 지도를 그릴 수 있다. path를 이용해 각 점을 선으로 연결하는 형태이므로 &lt;code&gt;geom_path()&lt;/code&gt;를 사용하면 되고 데이터에서 &lt;code&gt;long&lt;/code&gt;, &lt;code&gt;lat&lt;/code&gt;, &lt;code&gt;group&lt;/code&gt; 변수를 이용한다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;shp2_ffd&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
  aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;long&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; group&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;group&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_path&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/e1t1yel4pas24t6/unnamed-chunk-6-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;code&gt;NAME_1&lt;/code&gt; 변수를 기준으로 구분한 지도는 광역단체로만 구분이 되고, 아래와 같이 &lt;code&gt;NAME_2&lt;/code&gt; 변수를 기준으로 fortify시킨경우에는 시(도의 경우), 구(서울 등)로 구분되는 것을 볼 수 있다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;shp2_ffd2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
  aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;long&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; group&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;group&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_path&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/v2bkis5y2tf71tj/unnamed-chunk-7-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;code&gt;geom_path()&lt;/code&gt;가 아니라 &lt;code&gt;geom_polygon()&lt;/code&gt;을 사용하면 지역별로 색상을 채우는 것이 가능하다. 적용할만한 다른 데이터를 추가하면 히트맵이나 코로플레스같은 시각화를 할 수 있다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;shp2_ffd&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;long&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; group&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;group&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_polygon&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fill&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;id&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/tl02ufsiry4xgqz/unnamed-chunk-8-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;&lt;code&gt;dplyr&lt;/code&gt;패키지를 불러와서 난수를 데이터에 대입시키고 어떻게 ggplot2를 이용할 수 있을지 살펴보자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dplyr&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;shp2_value &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  shp2_ffd &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;id&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  distinct&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  value &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;runif&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

shp2_value
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##                   id value
## 1              Busan    24
## 2  Chungcheongbuk-do    76
## 3  Chungcheongnam-do    74
## 4              Daegu    22
## 5            Daejeon    73
## 6         Gangwon-do    68
## 7            Gwangju    34
## 8        Gyeonggi-do    88
## 9   Gyeongsangbuk-do    16
## 10  Gyeongsangnam-do    28
## 11           Incheon    98
## 12              Jeju    56
## 13      Jeollabuk-do    33
## 14      Jeollanam-do    41
## 15             Seoul    96
## 16             Ulsan    32
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;각 광역 단체에 적당한 값을 넣은 데이터 프레임을 만들었다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;shp2_data &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; shp2_ffd &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  left_join&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;shp2_value&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;shp2_data&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;long&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; group&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;group&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_polygon&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; value&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/o7319yk4d0mv023/unnamed-chunk-10-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;p&gt;원래의 fortify된 지도에 &lt;code&gt;left_join&lt;/code&gt;을 해서 값을 대입하고, 추가한 열을 &lt;code&gt;geom_polygon&lt;/code&gt;에서 fill값으로 잡아주면 된다. 색상을 변경하려면 scale 값을 조정해주는 함수를 사용하면 된다. 여기서는 &lt;code&gt;RColorBrewer&lt;/code&gt;패키지를 이용하는 &lt;code&gt;scale_fill_distiller&lt;/code&gt;함수를 사용했다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;shp2_data&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;long&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; group&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;group&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_polygon&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; value&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  scale_fill_distiller&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;palette &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Spectral&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/x91bxbrbve2j1in/unnamed-chunk-11-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;p&gt;이제 지도에서 일부분을 추출해보려고 한다. 예를 들어 서울만 지도를 그리고 싶다면, 맨 처음에 shp 파일을 불러왔을 때 &lt;code&gt;NAME_1&lt;/code&gt; 항목이 &lt;em&gt;Seoul&lt;/em&gt;인 것만 찾아서 &lt;code&gt;fortify&lt;/code&gt;시키면 된다. 이 경우에는 구별로 구분된 지도를 봐야 하기 때문에 region 구분은 &lt;code&gt;NAME_2&lt;/code&gt;를 기준으로 해야 한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;shp2_subset &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; shp2&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;shp2&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;NAME_1 &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Seoul&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,]&lt;/span&gt;
seoul_ffd &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fortify&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;shp2_subset&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; region&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;NAME_2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이후에는 위에서 했던 것과 같은 방식으로 지도를 그릴 수 있다&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;seoul_ffd&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;long&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lat&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; group&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;group&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_polygon&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fill&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;id&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/tdf3bk6cpqxfwiz/unnamed-chunk-13-1.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;http://lumiamitie.github.io/r/visualization/mapping-with-ggplot2&quot;&gt;Mapping with ggplot2+shp&lt;/a&gt; was originally published by Minho Lee at &lt;a href=&quot;http://lumiamitie.github.io&quot;&gt;lmnsh&lt;/a&gt; on August 08, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[koding.com 에서 Jekyll 활용하기]]></title>
  <link>http://lumiamitie.github.io/web/koding-com</link>
  <id>http://lumiamitie.github.io/web/koding-com</id>
  <published>2015-08-05T00:00:00+09:00</published>
  <updated>2015-08-05T00:00:00+09:00</updated>
  <author>
    <name>Minho Lee</name>
    <uri>http://lumiamitie.github.io</uri>
    <email>lumiamitie@email.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;img src=&quot;../../images/old-book.jpg&quot; alt=&quot;cover-image&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;koding.com&quot;&gt;Koding.com&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://koding.com&quot;&gt;Koding&lt;/a&gt;은 Amazon EC2 인스턴스를 기반으로 하는 서비스다. 가입하면 무료로 VM을 하나 받을 수 있다. RAM 1기가에 하드 3기가 뿐이지만 우분투가 기본적으로 설치되어있고, 파이썬이나 루비 등이 미리 세팅되어있다. 무료로 사용하는 동안에는 접속이 끊어지면 VM도 자동으로 종료된다.&lt;/p&gt;

&lt;p&gt;VM내부의 Web 폴더는 github.io 처럼 정적인 호스트를 제공하기 때문에 Jekyll 페이지를 테스트하는 용도로 사용하기로 했다. &lt;/p&gt;

&lt;p&gt;원래 jekyll 페이지를 작성하고 웹페이지로 변환시키려면 &lt;code&gt;jekyll serve&lt;/code&gt; 명령어를 사용한다. 우리는 변환시킨 결과물을 &lt;strong&gt;Web&lt;/strong&gt; 폴더에 보내려고 한다. 이 경우에는 &lt;em&gt;-d&lt;/em&gt; 옵션을 사용하고 (destination) 그 뒤에 대상 폴더의 주소를 지정하면 된다. (~/Web)&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;jekyll serve -d ~/Web
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 Koding.com의 VM이 켜져있는 동안에는 id.koding.io 에서 결과물을 확인할 수 있다&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;http://lumiamitie.github.io/web/koding-com&quot;&gt;koding.com 에서 Jekyll 활용하기&lt;/a&gt; was originally published by Minho Lee at &lt;a href=&quot;http://lumiamitie.github.io&quot;&gt;lmnsh&lt;/a&gt; on August 05, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[jekyll을 사용한 첫 게시물]]></title>
  <link>http://lumiamitie.github.io/web/%EC%B2%AB%EA%B2%8C%EC%8B%9C%EB%AC%BC</link>
  <id>http://lumiamitie.github.io/web/첫게시물</id>
  <published>2015-08-04T00:00:00+09:00</published>
  <updated>2015-08-04T00:00:00+09:00</updated>
  <author>
    <name>Minho Lee</name>
    <uri>http://lumiamitie.github.io</uri>
    <email>lumiamitie@email.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;img src=&quot;../../images/macphoto.jpg&quot; alt=&quot;cover-image&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;jekyll-notepad-테마를-적용한-블로그-게시&quot;&gt;jekyll Notepad 테마를 적용한 블로그 게시&lt;/h2&gt;

&lt;p&gt;일단은 koding.com에서 테스트 중이다
유료 계정이 아니라 종료하면 VM이 꺼지는데 그러면 호스팅도 종료가 되기 때문에 어느 정도 완성되면 github.io로 업로드할 예정이다&lt;/p&gt;

&lt;p&gt;dropbox에서 공유를 통해 받아오는 주소로는 커버이미지 적용이 안되는 것이 확인되었다
이것이 주소 또는 드랍박스의 문제인지 markdown 문법상의 문제인지 확인을 위해 구글에서 검색한 이미지로 커버 등록을 시도한다&lt;/p&gt;

&lt;p&gt;구글에서 검색한 이미지의 주소로 바로 링크했을 때는 커버 등록이 되는 것을 확인했다&lt;/p&gt;

&lt;p&gt;&lt;em&gt;images&lt;/em&gt;폴더에 저장된 그림파일을 불러오기 위해서는 ../../images/그림파일 의 주소로 연결해주면 된다&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;www.pexels.com&quot;&gt;pexels&lt;/a&gt;에서 이용 가능한 사진들을 찾았다&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;http://lumiamitie.github.io/web/%EC%B2%AB%EA%B2%8C%EC%8B%9C%EB%AC%BC&quot;&gt;jekyll을 사용한 첫 게시물&lt;/a&gt; was originally published by Minho Lee at &lt;a href=&quot;http://lumiamitie.github.io&quot;&gt;lmnsh&lt;/a&gt; on August 04, 2015.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[마크다운에 Dropbox 공유 이미지 링크하기]]></title>
  <link>http://lumiamitie.github.io/web/image-link-test</link>
  <id>http://lumiamitie.github.io/web/image-link-test</id>
  <published>2015-08-04T00:00:00+09:00</published>
  <updated>2015-08-04T00:00:00+09:00</updated>
  <author>
    <name>Minho Lee</name>
    <uri>http://lumiamitie.github.io</uri>
    <email>lumiamitie@email.com</email>
  </author>
  <content type="html">&lt;p&gt;&lt;img src=&quot;../../images/taking-notes.jpg&quot; alt=&quot;cover-image&quot;&gt;&lt;/p&gt;

&lt;p&gt;커버이미지를 등록하는 것 때문에 매번 필요한 사진이 생기면 다운로드 받아서 jekyll 폴더에 넣어줘야 하는지 고민하다가 Dropbox에 사진을 넣고 공유해서 그 링크를 첨부하는 방식을 생각했다. 그런데 막상 해보니 제대로 링크가 연결되지 않아서 파일을 직접 넣어주는 방향으로 생각하고 있었는데, 마크다운 문법 때문에 블로그를 돌아다니다가 &lt;a href=&quot;http://scriptogr.am/myevan/post/markdown-syntax-guide-for-scriptogram&quot;&gt;Song Young-jin님의 블로그&lt;/a&gt;에서 적절한 해결 방안을 발견했다.&lt;/p&gt;

&lt;p&gt;원래 공유를 하면 다음과 같은 링크가 주어진다&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.dropbox.com/s/randomrandom/image.png?dl=0&quot;&gt;https://www.dropbox.com/s/randomrandom/image.png?dl=0&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;여기서 https 를 http로, www를 dl로 변경하고 ?dl=0 을 제거한다&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://dl.dropbox.com/s/randomrandom/image.png&quot;&gt;http://dl.dropbox.com/s/randomrandom/image.png&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;위 링크를 사용하면 마크다운에서 Dropbox 공유 이미지를 불러올 수 있다&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/s/hw5qjxa91jy560g/apple_mean_price.png&quot; alt=&quot;서울시 구별 사과 평균가격&quot;&gt;&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;http://lumiamitie.github.io/web/image-link-test&quot;&gt;마크다운에 Dropbox 공유 이미지 링크하기&lt;/a&gt; was originally published by Minho Lee at &lt;a href=&quot;http://lumiamitie.github.io&quot;&gt;lmnsh&lt;/a&gt; on August 04, 2015.&lt;/p&gt;</content>
</entry>

</feed>
